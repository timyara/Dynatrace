{"version":15,"variables":[{"key":"Status","type":"csv","input":"OPEN,RESOLVED,All","multiple":false,"visible":true},{"key":"MuteStatus","type":"csv","input":"MUTED,NOT_MUTED,All","multiple":false,"visible":true},{"key":"StackLevel","type":"query","input":"fetch events\n| filter event.kind == \"SECURITY_EVENT\"\n| filter event.category == \"VULNERABILITY_MANAGEMENT\"\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\" | filter event.level == \"ENTITY\" | summarize takeLast(vulnerability.id), by: vulnerability.stack | fields values = vulnerability.stack","multiple":true,"visible":true},{"key":"RiskLevel","type":"query","input":"fetch events\n| filter event.kind == \"SECURITY_EVENT\"\n| filter event.category == \"VULNERABILITY_MANAGEMENT\"\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\" | filter event.level == \"ENTITY\" | summarize takeLast(vulnerability.id), by: vulnerability.parent.risk.level | fields values = vulnerability.parent.risk.level","multiple":true,"visible":true}],"tiles":{"0":{"type":"data","title":"","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| summarize total=arraySize(arrayRemoveNulls(collectDistinct(vulnerability.id)))\n| fields `Total vulnerabilities` = if(isNull(total), 0, else:total)","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Total vulnerabilities"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Total vulnerabilities","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"1":{"type":"markdown","title":"","content":"# Third-party vulnerabilities exposure report\n\nTrack and report your organization's exposure to third-party vulnerabilities.\n\n#### Use this template to answer the following security questions:\n\n* Is your organization exposed to threat-related vulnerabilities?\n* What areas of your environment are at risk?\n* How has the exposure changed over time?\n\n*Note: Dashboard contents are calculated and displayed according to set [variable values](https://www.dynatrace.com/support/help/observe-and-explore/dashboards-new/get-started/dashboards-use#dashboard-variable-set).*"},"2":{"type":"markdown","title":"","content":"![](https://dt-cdn.net/images/appsec-logo-with-bg-and-rounded-corners-200-8253a2bc6e.png)\n### Dynatrace AppSec"},"3":{"type":"data","title":"","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| limit 1\n| fields\n`Last analyzed data`=formatTimestamp(timestamp, format:\"YYYY-MM-dd\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Last analyzed data","categoryAxisLabel":"Last analyzed data","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":true,"label":"","autoscale":false,"recordField":"Last analyzed data"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Last analyzed data"},"displayedFields":["Last analyzed data"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"singleValueSettings":{"showLabel":false,"suffix":"","autoscale":true},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"4":{"type":"markdown","title":"","content":"## ðŸ’¥ Exposure summary\n---\nYour environment's exposure to vulnerabilities, the affected or related entities, and the exploitation risk."},"5":{"type":"markdown","title":"","content":"### Risk"},"6":{"type":"markdown","title":"","content":"### Vulnerabilities"},"7":{"type":"markdown","title":"","content":"### Impact"},"8":{"type":"data","title":"","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| summarize {\nOpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\nResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\nMutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\nResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\nMuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.id}\n| fields\nStatus=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",1,\n             else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",0,\n             else:2))\n| summarize WorstStatus = takeMax(Status)\n| fields Status = if(WorstStatus==1, concat(\"âš ï¸\",\" \",\"All muted\"), else:if(WorstStatus==0, \"All resolved\", else:concat(\"ðŸ”¥\",\" Vulnerable\")))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Status","categoryAxisLabel":"Status","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":true,"alignment":"center","recordField":"Status"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Status"},"displayedFields":["Status"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"singleValueSettings":{"showLabel":false,"suffix":"","autoscale":true},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"9":{"type":"data","title":"","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n    Critical=countIf(vulnerability.risk.level==\"CRITICAL\"),\n    High=countIf(vulnerability.risk.level==\"HIGH\"),\n    Medium=countIf(vulnerability.risk.level==\"MEDIUM\"),\n    Low=countIf(vulnerability.risk.level==\"LOW\"),\n    maxScore=takeMax(vulnerability.risk.score)\n}, by: {vulnerability.id}\n  | summarize {\n    Critical=countIf(Critical>0),\n    High=countIf(High>0),\n    Medium=countIf(Medium>0),\n    Low=countIf(Low>0)\n}\n| fields `Most severe vulnerabilities`=if(Critical>0,concat(\"Critical: \",Critical), else:\n                                       if(High>0,concat(\"High: \",High), else:\n                                       if(Medium>0,concat(\"Medium: \",Medium), else:\n                                       concat(\"Low: \",Low))))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Most severe vulnerabilities","categoryAxisLabel":"Most severe vulnerabilities","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":true,"alignment":"center","recordField":"Most severe vulnerabilities"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Most severe vulnerabilities"},"displayedFields":["Most severe vulnerabilities"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"10":{"type":"data","title":"Related applications","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.applications.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Related applications`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Related applications","categoryAxisLabel":"Related applications","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Related applications"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Related applications"},"displayedFields":["Related applications"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["Related services"]]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"11":{"type":"code","title":"Exploitation Risk Score (0-100)","input":"import { queryExecutionClient } from '@dynatrace-sdk/client-query';\n\nexport default async function () {\n\nconst From=$dt_timeframe_from;\nconst To=$dt_timeframe_to;\nconst Status = $Status;\nconst MuteStatus = $MuteStatus;\nconst StackLevel = $StackLevel.join('\",\"');\nconst RiskLevel = $RiskLevel.join('\",\"');\n\nasync function pollQuery(requestToken, resolve) {\n\n  const poll = await queryExecutionClient.queryPoll({requestToken, requestTimeoutMilliseconds: 3000});\n  if(poll.result) {\n      resolve(poll.result);\n  } else {\n      pollQuery(requestToken, resolve);\n  }\n}\nfunction runQuery (query) {\n  return new Promise(async (resolve, reject) => {\n\n      const queryExecution = await queryExecutionClient.queryExecute({body: { query }});\n      if(queryExecution.result) {\n          resolve(queryExecution.result);\n      } else {\n          pollQuery(queryExecution.requestToken, resolve)\n      }\n\n  });\n}\n\n const commonFilterQueryPart = `fetch events, from:toTimestamp(\"${From}\"), to:toTimestamp(\"${To}\")\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == \"${Status}\" OR \"All\" == \"${Status}\"\n| filter vulnerability.parent.mute.status == \"${MuteStatus}\" OR \"All\" == \"${MuteStatus}\"\n| filter in(vulnerability.stack,\"${StackLevel}\")\n| filter in(vulnerability.parent.risk.level,\"${RiskLevel}\")\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"`;\n\n\n const vulnBySeverityQueryString = `${commonFilterQueryPart}\n | summarize\n{\nCritical=countIf(vulnerability.risk.level==\"CRITICAL\"),\nHigh=countIf(vulnerability.risk.level==\"HIGH\"),\nMedium=countIf(vulnerability.risk.level==\"MEDIUM\"),\nLow=countIf(vulnerability.risk.level==\"LOW\"),\nmaxScore=takeMax(vulnerability.risk.score)\n}, by: {vulnerability.display_id}\n| summarize {\nC=countIf(Critical>0),\nH=countIf(High>0),\nM=countIf(Medium>0),\nL=countIf(Low>0)\n}`;\n\n const avgRiskScoreQueryString = `${commonFilterQueryPart}\n | sort timestamp, direction:\"descending\"\n | summarize {\n average=round(avg(toDouble(vulnerability.risk.score)),decimals:1)\n }, by:{risk=vulnerability.risk.level}`;\n\n\n  // Get the counts per risk level using DQL\n  console.log(vulnBySeverityQueryString);\n  const vulnBySeverityQueryResult = await runQuery(vulnBySeverityQueryString);\n\n  if (vulnBySeverityQueryResult.records == null || vulnBySeverityQueryResult.records.length==0){\n    return \"No Data\";\n  }\n  const vulnBySeverity=vulnBySeverityQueryResult.records[0];\n\n    // Define data set: Number of problems per criticality level\n\n    // Get the avg score per risk level using DQL\n  const avgRiskScoreQueryResult = await runQuery(avgRiskScoreQueryString);\n\n  const avgRiskScore=avgRiskScoreQueryResult.records.reduce((obj,record)=>{\n\n    if(record == null ||  obj == null || record.average == null) return;\n    if(record.risk==\"CRITICAL\"){\n      obj.C=record.average;\n    }\n    if(record.risk==\"HIGH\"){\n      obj.H=record.average;\n    }\n    if(record.risk==\"MEDIUM\"){\n      obj.M=record.average;\n    }\n    if(record.risk==\"LOW\"){\n      obj.L=record.average;\n    }\n    return obj;\n  },{\"C\":0,\"H\":0,\"M\":0,\"L\":0});\n\n  // Define weights of the criticality level. Higher weight means that the contribution in the highest criticality level is higher.\n  const weights = {\n    \"C\": 60,\n    \"H\": 20,\n    \"M\": 5,\n    \"L\": 1,\n  };\n\n  // Define ranges for the criticality levels\n  const scoreRanges = {\n      \"C\": [9, 10],\n      \"H\": [7, 9],\n      \"M\": [4, 7],\n      \"L\": [0.5, 4],\n    };\n\n\n  // Normalize the average risk score of each severity against the score range of that severity (output between 0 and 1).\n  const normalizedAvgSeverities={}\n  for(const[severity, avg] of Object.entries(avgRiskScore)){\n    const minScore=scoreRanges[severity][0];\n    const maxScore=scoreRanges[severity][1];\n    const scoreRange=maxScore-minScore;\n    normalizedAvgSeverities[severity]=(avgRiskScore[severity]-minScore)/scoreRange;\n  }\n    // Define logistic function and scale to make sense of the amount of problems in a criticality level (output is always between 0 and 1)\n    const scale=10\n    function logistic(x) {\n      return Math.tanh(x/scale)\n    }\n\n    const severities = Object.keys(vulnBySeverity);\n\n    let score=0;\n    let minScore=0;\n    let maxScore=0;\n\n    const unrelevantSeverities=[];\n\n    // Calculate min/max and the distance between min and max (the final score range) in the highest available criticality level\n    for (const severity of severities) {\n      if (vulnBySeverity[severity] >= 1) {\n        minScore=scoreRanges[severity][0];\n        maxScore=scoreRanges[severity][1];\n        break;\n      }else{\n        // Remove all severities that are above the maximum range to have a better result for lower scores\n        unrelevantSeverities.push(severity);\n      }\n    }\n    const scoreRange=maxScore-minScore;\n\n    const relevantWeights=Object.fromEntries(Object.entries(weights).filter(([severity,weight]) => !unrelevantSeverities.includes(severity)));\n    const relevantSeverities=severities.filter((severity,weight) => !unrelevantSeverities.includes(severity));\n\n\n    // Convert weights into percentage based ratios\n    const weightRatios={};\n    let totalWeight = Object.values(relevantWeights).reduce((acc, number) => acc + number, 0);\n    for(const[severity, weight] of Object.entries(relevantWeights)){\n      weightRatios[severity]=weight/totalWeight;\n    }\n\n    // Increase the min score of the highest criticality level by the score contribution of each criticality level (based on weight and count)\n    let addedScore=0;\n    for(const severity of relevantSeverities){\n      const maxAddedScore=weightRatios[severity]*scoreRange;\n      const scoreContribution=maxAddedScore*logistic(vulnBySeverity[severity])*normalizedAvgSeverities[severity];\n      addedScore+=scoreContribution\n    }\n\n    // Calculate final score\n    const finalScore= (minScore + addedScore)*10;\n    let scoreStr=finalScore.toPrecision(2);\n    return scoreStr;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"element","categoryAxisLabel":"element","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","sparklineSettings":{"isVisible":false},"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"element"},"displayedFields":["element"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"singleValueSettings":{"showLabel":false,"suffix":"","autoscale":true}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"12":{"type":"data","title":"Open","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| sort timestamp, direction:\"descending\"\n| summarize {\n  OpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n  ResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n  MutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\n  ResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\n  MuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.id}\n| fieldsAdd\n  Status=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n               else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n               else:\"OPEN\"))\n| summarize\n  Open=countIf(Status==\"OPEN\")\n| fields Open=if(Open>0,Open,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","sparklineSettings":{"isVisible":false},"prefixIcon":"ApplicationSecuritySignetIcon","recordField":"Open"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Open","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"13":{"type":"data","title":"Resolved","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| summarize {\n    OpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n    ResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n    MutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\n    ResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\n    MuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.id}\n| fieldsAdd\nStatus=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n             else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n             else:\"OPEN\"))\n| summarize\n`Muted`=countIf(Status==\"MUTED\"),\n`Resolved`=countIf(Status==\"RESOLVED\"),\n`Open`=countIf(Status==\"OPEN\")\n| fields Resolved=if(Resolved>0,Resolved,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Resolved","categoryAxisLabel":"Resolved","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":true,"alignment":"center","prefixIcon":"SecurityResolvedIcon","recordField":"Resolved"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Resolved"},"displayedFields":["Resolved"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"14":{"type":"data","title":"Muted","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| sort timestamp, direction:\"descending\"\n| summarize {\n  OpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n  ResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n  MutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\n  ResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\n  MuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.id}\n| fieldsAdd\n  Status=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n               else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n               else:\"OPEN\"))\n| summarize\n  Muted=countIf(Status==\"MUTED\"),\n  Resolved=countIf(Status==\"RESOLVED\"),\n  Open=countIf(Status==\"OPEN\")\n| fields Muted=if(Muted>0,Muted,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Muted","categoryAxisLabel":"Muted","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","prefixIcon":"NotificationOffIcon","recordField":"Muted"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Muted"},"displayedFields":["Muted"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"15":{"type":"data","title":"Related services","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.services.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Related services`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","sparklineSettings":{"isVisible":false},"recordField":"Related services"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Related services","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["Related services"]]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"16":{"type":"data","title":"Related databases","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.databases.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Related databases`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Related databases"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Related databases","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"17":{"type":"data","title":"Vulnerability count by risk level ","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\nCritical=countIf(vulnerability.risk.level==\"CRITICAL\"),\nHigh=countIf(vulnerability.risk.level==\"HIGH\"),\nMedium=countIf(vulnerability.risk.level==\"MEDIUM\"),\nLow=countIf(vulnerability.risk.level==\"LOW\"),\nmaxScore=takeMax(vulnerability.risk.score)\n}, by: {vulnerability.id}\n| fieldsAdd riskLevel=if(Critical>0,\"CRITICAL\", else:\n                         if(High>0,\"HIGH\", else:\n                         if(Medium>0,\"MEDIUM\", else:\n                         if(Low>0,\"LOW\"))))\n| filterOut isNull(riskLevel)\n| summarize {\nVulnerabilities=count(),\nmaxScore=takeMax(maxScore)\n}, by:riskLevel\n| sort maxScore, direction:\"descending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"donutChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","colorPalette":"security-risk-level","circleChartSettings":{"hideLabels":false,"groupingThresholdType":"relative"},"legend":{"hidden":false,"position":"bottom"},"categoricalBarChartSettings":{"categoryAxisLabel":"Risk level","valueAxisLabel":"","layout":"horizontal","scale":"absolute","categoryAxisTickLayout":"horizontal","categoryAxis":"riskLevel","valueAxis":"Vulnerabilities"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"riskLevel"},"table":{"enableLineWrap":true,"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{"value":"Vulnerabilities"},"displayedFields":["riskLevel"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Vulnerabilities","rangeAxis":""},{"valueAxis":"maxScore","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"18":{"type":"data","title":"Software components","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize softwareComponents=arrayRemoveNulls(collectDistinct(affected_entity.vulnerable_component.id))\n| fields softwareComponents=arraySize(softwareComponents)\n| fields `Software components`=if(softwareComponents>0,softwareComponents,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Software components"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Software components","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"19":{"type":"data","title":"Vulnerable functions","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize affected_entity.vulnerable_functions=collectDistinct(affected_entity.vulnerable_functions)\n| fields affected_entity.vulnerable_functions=arraySize(arrayRemoveNulls(affected_entity.vulnerable_functions))\n| fields `Vulnerable functions`=if(affected_entity.vulnerable_functions>0,affected_entity.vulnerable_functions,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Vulnerable functions"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Vulnerable functions","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"20":{"type":"markdown","title":"","content":"<br/><br/>\n__Exploitation Risk Score (ERS)__ is a dynamic, weighted score that leverages the Davis Security Score (DSS) of each vulnerability and the actual number of vulnerabilities per risk level. ERS represents the likelihood of a potential attacker exploiting open vulnerabilities from the filtered scope.\n\nHow ERS is calculated:\n1. DSS average and vulnerability counts are calculated per risk level (critical, high, etc.).\n2. A weighted function is applied per risk level to adjust the averages to the respective vulnerability counts.\n3. All scores are aggregated in an iterative manner starting with the highest risk level to derive a single score out of 100.\n\n__Note__: Higher scores represent higher risk. Scores above 90 involve critical vulnerabilities."},"21":{"type":"data","title":"Affected processes","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=affected_entity.affected_processes.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Affected Processes`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Affected Processes"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Affected Processes","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"22":{"type":"data","title":"Affected process groups","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n  affected_entity.type=takeAny(affected_entity.type),\nby: {affected_entity.id}\n| summarize\n  entities=countIf(affected_entity.type==\"PROCESS_GROUP\")\n| fields `Affected process groups`=if(entities>0,entities,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Affected process groups"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Affected process groups","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"23":{"type":"data","title":"Related hosts","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.hosts.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Related hosts`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Related hosts"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Related hosts","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"24":{"type":"data","title":"Affected hosts","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n  affected_entity.type=takeAny(affected_entity.type),\nby: {affected_entity.id}\n| summarize\n  affectedHosts=countIf(affected_entity.type==\"HOST\")\n| fields `Affected hosts`=if(affectedHosts>0,affectedHosts,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Affected hosts"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Affected hosts","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"25":{"type":"data","title":"Related Kubernetes workloads","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.kubernetes_workloads.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Related Kubernetes workloads`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Related Kubernetes workloads"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Related Kubernetes workloads","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"26":{"type":"markdown","title":"","content":"<br/><br/>"},"27":{"type":"markdown","title":"","content":"## ðŸ“ˆ Risk analysis\n---\nVulnerability counts and trends based on Davis risk level assessment. __Note__: _Change_ marks changes occurred within the set timeframe."},"28":{"type":"markdown","title":"","content":"### Vulnerabilities by risk level"},"29":{"type":"data","title":"","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize {\n    maxRiskScore=round(takeMax(toDouble(vulnerability.risk.score)),decimals:1)\n}\n| fieldsAdd\n    riskLevel=if(maxRiskScore>9,\"CRITICAL\",else:if(maxRiskScore>7,\"HIGH\",else:if(maxRiskScore>4,\"MEDIUM\",else:\"LOW\"))),\n    riskScore=maxRiskScore\n| fields `Highest Davis Security Score`=if(riskLevel==\"CRITICAL\",concat(\"ðŸš¨\",\" CRITICAL(\",riskScore,\")\"),\n    else:if(riskLevel==\"HIGH\",concat(\"â—\",\" HIGH(\",riskScore,\")\"),\n    else:concat(riskLevel,\"(\",riskScore,\")\")))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Highest Davis Security Score","categoryAxisLabel":"Highest Davis Security Score","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"alignment":"center","recordField":"Highest Davis Security Score"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Highest Davis Security Score"},"displayedFields":["Highest Davis Security Score"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Highest Davis Security Score","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"30":{"type":"data","title":"Critical","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n  Critical=countIf(vulnerability.risk.level==\"CRITICAL\")\n}, by: {vulnerability.id}\n| summarize\n  Critical=countIf(Critical>0)\n| fields Critical=if(Critical>0,Critical,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"SecurityCriticalIcon","alignment":"start","recordField":"Critical"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Critical","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Highest Davis Security Score","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"31":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n  Vulnerabilities=countIf(vulnerability.risk.level==\"CRITICAL\")\n}, by: { {bin(timestamp,1h),alias:timestamp}, vulnerability.id}\n| summarize\n{\n  Vulnerabilities=countIf(Vulnerabilities>0)},\n  by: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize start = takeLast(Vulnerabilities), end = takeFirst(Vulnerabilities)\n| fields delta=end-start\n| fields `Critical delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Critical delta","categoryAxisLabel":"Critical delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Critical delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Critical delta"},"displayedFields":["Critical delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"32":{"type":"data","title":"Vulnerability count by risk level ","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n  Critical=countIf(vulnerability.risk.level==\"CRITICAL\"),\n    High=countIf(vulnerability.risk.level==\"HIGH\"),\n    Medium=countIf(vulnerability.risk.level==\"MEDIUM\"),\n    Low=countIf(vulnerability.risk.level==\"LOW\")\n}, by: { bin(timestamp,1h),alias:timestamp, vulnerability.display_id}\n| summarize\nLow=countIf(Critical==0 AND High==0 AND Medium==0 AND Low>0),\nMedium=countIf(Critical==0 AND High==0 AND Medium>0),\nHigh=countIf(Critical==0 AND High>0),\nCritical=countIf(Critical>0),\n  by: {timestamp}\n| sort timestamp, direction:\"descending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":false,"position":"right"},"colorPalette":"security-risk-level","fieldMapping":{"timestamp":"timestamp","leftAxisValues":["Low","Medium","High","Critical"],"leftAxisDimensions":[],"rightAxisValues":[]},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Low","rangeAxis":""},{"valueAxis":"Medium","rangeAxis":""},{"valueAxis":"High","rangeAxis":""},{"valueAxis":"Critical","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Davis Security Score","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"33":{"type":"data","title":"High","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n  High=countIf(vulnerability.risk.level==\"HIGH\")\n}, by: {vulnerability.id}\n| summarize\n  High=countIf(High>0)\n| fields High=if(High>0,High,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"SecurityHighIcon","alignment":"start","recordField":"High"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"High","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Highest Davis Security Score","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"34":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n  Vulnerabilities=countIf(vulnerability.risk.level==\"HIGH\")\n}, by: { {bin(timestamp,1h),alias:timestamp}, vulnerability.id}\n| summarize\n{\n  Vulnerabilities=countIf(Vulnerabilities>0)},\n  by: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize start = takeLast(Vulnerabilities), end = takeFirst(Vulnerabilities)\n| fields delta=end-start\n| fields `High delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"High delta","categoryAxisLabel":"High delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"High delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"High delta"},"displayedFields":["High delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"35":{"type":"data","title":"Medium","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\nCritical=countIf(vulnerability.risk.level==\"CRITICAL\"),\nHigh=countIf(vulnerability.risk.level==\"HIGH\"),\nMedium=countIf(vulnerability.risk.level==\"MEDIUM\")\n}, by: {vulnerability.id}\n| summarize\nMedium=countIf(Critical==0 AND High==0 AND Medium>0)\n| fields Medium=if(Medium>0,Medium,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"SecurityMediumIcon","alignment":"start","recordField":"Medium"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Medium","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Highest Davis Security Score","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"36":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n  Vulnerabilities=countIf(vulnerability.risk.level==\"MEDIUM\")\n}, by: { {bin(timestamp,1h),alias:timestamp}, vulnerability.id}\n| summarize\n{\n  Vulnerabilities=countIf(Vulnerabilities>0)},\n  by: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize start = takeLast(Vulnerabilities), end = takeFirst(Vulnerabilities)\n| fields delta=end-start\n| fields `Low delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Low delta","categoryAxisLabel":"Low delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Low delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Low delta"},"displayedFields":["Low delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"37":{"type":"data","title":"Low","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\nCritical=countIf(vulnerability.risk.level==\"CRITICAL\"),\nHigh=countIf(vulnerability.risk.level==\"HIGH\"),\nMedium=countIf(vulnerability.risk.level==\"MEDIUM\"),\nLow=countIf(vulnerability.risk.level==\"LOW\")\n}, by: {vulnerability.id}\n| summarize\nLow=countIf(Critical==0 AND High==0 AND Medium==0 AND Low>0)\n| fields Low=if(Low>0,Low,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"SecurityIcon","alignment":"start","recordField":"Low"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Low","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Highest Davis Security Score","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"38":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n  Vulnerabilities=countIf(vulnerability.risk.level==\"LOW\")\n}, by: { {bin(timestamp,1h),alias:timestamp}, vulnerability.id}\n| summarize\n{\n  Vulnerabilities=countIf(Vulnerabilities>0)},\n  by: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize start = takeLast(Vulnerabilities), end = takeFirst(Vulnerabilities)\n| fields delta=end-start\n| fields `Low delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Low delta","categoryAxisLabel":"Low delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Low delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Low delta"},"displayedFields":["Low delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"39":{"type":"markdown","title":"","content":"### Vulnerabilities by Davis assessment\n#### Number of vulnerabilities with:"},"40":{"type":"data","title":"Vulnerable functions in use","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n  vulnerableFunctions=countIf(vulnerability.davis_assessment.vulnerable_function_status==\"IN_USE\")\n}, by: {vulnerability.id}\n| summarize\n{\n  vulnerableFunctions=countIf(vulnerableFunctions>0)\n}\n| fields `With functions in use`=if(vulnerableFunctions>0,vulnerableFunctions,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"VulnerableFunctionIcon","alignment":"start","recordField":"With functions in use"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"With functions in use","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"41":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\nvulnerableFunctions=countIf(vulnerability.davis_assessment.vulnerable_function_status==\"IN_USE\")\n}, by: {vulnerability.id,bin(timestamp,1h),alias:timestamp}\n| summarize\n{\nvulnerableFunctions=countIf(vulnerableFunctions>0)\n}, by:{timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\nstart = takeLast(vulnerableFunctions),\nend = takeFirst(vulnerableFunctions)\n| fields delta=end-start\n| fields `Function usage delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\")) //  ID:vulnerable-function-usage-change-risk-analysis:risk-analysis","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Function usage delta","categoryAxisLabel":"Function usage delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Function usage delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Function usage delta"},"displayedFields":["Function usage delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"42":{"type":"data","title":"Vulnerability count by assessment","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n`Internet exposure`=countIf(vulnerability.davis_assessment.exposure_status==\"PUBLIC_NETWORK\"),\n`Exploit available`=countIf(vulnerability.davis_assessment.exploit_status==\"AVAILABLE\"),\n`Function in use`=countIf(vulnerability.davis_assessment.vulnerable_function_status==\"IN_USE\"),\n`Reachable data assets`=countIf(vulnerability.davis_assessment.data_assets_status==\"REACHABLE\")\n}, by: {vulnerability.display_id,bin(timestamp,1h),alias:timestamp}\n| summarize\n{\n`Reachable data assets`=countIf(`Reachable data assets`>0),\n`Public exploit`=countIf(`Exploit available`>0),\n`Public internet exposure`=countIf(`Internet exposure`>0),\n`Vulnerable functions in use`=countIf(`Function in use`>0)\n}, by:{timestamp}\n| sort timestamp, direction:\"descending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":false,"position":"right"},"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["Reachable data assets","Public exploit","Public internet exposure","Vulnerable functions in use"],"leftAxisDimensions":[],"rightAxisValues":[]},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":true,"label":"","autoscale":false,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Reachable data assets","rangeAxis":""},{"valueAxis":"Public exploit","rangeAxis":""},{"valueAxis":"Public internet exposure","rangeAxis":""},{"valueAxis":"Vulnerable functions in use","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"43":{"type":"data","title":"Public internet exposure","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\nexposure=countIf(vulnerability.davis_assessment.exposure_status==\"PUBLIC_NETWORK\")\n}, by: {vulnerability.id}\n| summarize\n{\nexposure=countIf(exposure>0)\n}\n| fields `With internet exposure`=if(exposure>0,exposure,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"PublicExposureIcon","alignment":"start","recordField":"With internet exposure"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"With internet exposure","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"44":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\ninternetExposure=countIf(vulnerability.davis_assessment.exposure_status==\"PUBLIC_NETWORK\")\n}, by: {vulnerability.id,bin(timestamp,1h),alias:timestamp}\n| summarize\n{\ninternetExposure=countIf(internetExposure>0)\n}, by:{timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\nstart = takeLast(internetExposure),\nend = takeFirst(internetExposure)\n| fields delta=end-start\n| fields `Internet exposure delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Internet exposure delta","categoryAxisLabel":"Internet exposure delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Internet exposure delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Internet exposure delta"},"displayedFields":["Internet exposure delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"45":{"type":"data","title":"Public exploit","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\nexploit=countIf(vulnerability.davis_assessment.exploit_status==\"AVAILABLE\")\n}, by: {vulnerability.id}\n| summarize\n{\nexploit=countIf(exploit>0)\n}\n| fields `With available exploit`=if(exploit>0,exploit,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"ExploitIcon","alignment":"start","recordField":"With available exploit"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"With available exploit","rangeAxis":""}]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"46":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\nexploit=countIf(vulnerability.davis_assessment.exploit_status==\"AVAILABLE\")\n}, by: {vulnerability.id,bin(timestamp,1h),alias:timestamp}\n| summarize\n{\nexploit=countIf(exploit>0)\n}, by:{timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\nstart = takeLast(exploit),\nend = takeFirst(exploit)\n| fields delta=end-start\n| fields `Exploit delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Exploit delta","categoryAxisLabel":"Exploit delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Exploit delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Exploit delta"},"displayedFields":["Exploit delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"47":{"type":"data","title":"Reachable data assets","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\n  dataAssets=countIf(vulnerability.davis_assessment.data_assets_status==\"REACHABLE\")\n}, by: {vulnerability.id}\n| summarize\n{\n  dataAssets=countIf(dataAssets>0)\n}\n| fields `With data assets in reach`=if(dataAssets>0,dataAssets,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"AssetIcon","alignment":"start","recordField":"With data assets in reach"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"With data assets in reach","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"48":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{\ndataAssets=countIf(vulnerability.davis_assessment.data_assets_status==\"REACHABLE\")\n}, by: {vulnerability.id,bin(timestamp,1h),alias:timestamp}\n| summarize\n{\ndataAssets=countIf(dataAssets>0)\n}, by:{timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\nstart = takeLast(dataAssets),\nend = takeFirst(dataAssets)\n| fields delta=end-start\n| fields `Data assets delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Data assets delta","categoryAxisLabel":"Data assets delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Data assets delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Data assets delta"},"displayedFields":["Data assets delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"49":{"type":"markdown","title":"","content":"## ðŸ” Vulnerability details\n---\nVulnerability status, trends, and priority list. __Note__: _Change_ marks changes occurred within the set timeframe."},"50":{"type":"markdown","title":"","content":"### Status trends"},"51":{"type":"data","title":"","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| summarize total=arraySize(collectDistinct(vulnerability.id))\n| fields `Total vulnerabilities` = if(isNull(total), 0, else:total)","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":true,"label":"","autoscale":true,"alignment":"center","recordField":"Total vulnerabilities"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Total vulnerabilities","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"52":{"type":"data","title":"Vulnerability count by status","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| sort timestamp, direction:\"descending\"\n| summarize {\nOpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\nResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\nMutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\nResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\nMuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.display_id, bin(timestamp,1h),alias:timestamp}\n| fieldsAdd\nStatus=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n             else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n             else:\"OPEN\"))\n| summarize\nOpen=countIf(Status==\"OPEN\"),\nMuted=countIf(Status==\"MUTED\"),\nby: {timestamp}\n| sort timestamp, direction:\"descending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":false,"position":"right"},"colorPalette":"vulnerability-status","fieldMapping":{"timestamp":"timestamp","leftAxisValues":["Open","Muted"],"leftAxisDimensions":[],"rightAxisValues":[]},"seriesOverrides":[{"seriesId":"Open","override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #d50b34)","Hover":"var(--dt-colors-charts-categorical-color-12-hover, #b30024)","Active":"var(--dt-colors-charts-categorical-color-12-active, #7e071d)","DefaultTransparent":"var(--dt-colors-charts-categorical-color-12-default-transparent, #c5000ccc)","HoverTransparent":"var(--dt-colors-charts-categorical-color-12-hover-transparent, #83000fcc)","ActiveTransparent":"var(--dt-colors-charts-categorical-color-12-active-transparent, #140000cc)"}}}]},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Open","rangeAxis":""},{"valueAxis":"Muted","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Davis Security Score","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"53":{"type":"data","title":"","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| summarize {\nOpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\nResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\nMutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\nResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\nMuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.id}\n| fieldsAdd\nStatus=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n             else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n             else:\"OPEN\"))\n| summarize\n`Muted`=countIf(Status==\"MUTED\"),\n`Resolved`=countIf(Status==\"RESOLVED\"),\n`Open`=countIf(Status==\"OPEN\")\n| fields Open=if(Open>0,Open,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":true,"label":"","autoscale":false,"alignment":"start","prefixIcon":"ApplicationSecuritySignetIcon","recordField":"Open"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Open","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"54":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| sort timestamp, direction:\"descending\"\n  | summarize {\n    OpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n    ResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n    MutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\n    ResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\n    MuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.display_id, bin(timestamp,1h),alias:timestamp}\n| fieldsAdd\n  Status=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n  else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n  else:\"OPEN\"))\n| summarize\n  Open=countIf(Status==\"OPEN\"),\nby: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize start = takeLast(Open), end = takeFirst(Open)\n| fields delta=end-start\n| fields `Open delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Open delta","categoryAxisLabel":"Open delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Open delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Open delta"},"displayedFields":["Open delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"55":{"type":"data","title":"","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| summarize {\n  OpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n  ResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n  MutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\n  ResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\n  MuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.id}\n| fieldsAdd\nStatus=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n             else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n             else:\"OPEN\"))\n| summarize\nMuted=countIf(Status==\"MUTED\")\n| fields Muted=if(Muted>0,Muted,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Muted","categoryAxisLabel":"Muted","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":true,"label":"","autoscale":false,"alignment":"start","prefixIcon":"NotificationOffIcon","recordField":"Muted"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Muted"},"displayedFields":["Muted"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"56":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n  | sort timestamp, direction:\"descending\"\n  | summarize {\n    OpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n    ResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n    MutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\n    ResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\n    MuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.display_id, bin(timestamp,1h),alias:timestamp}\n| fieldsAdd\n  Status=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n  else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n  else:\"OPEN\"))\n| summarize\n  Open=countIf(Status==\"OPEN\"),\n  Resolved=countIf(Status==\"RESOLVED\"),\n  Muted=countIf(Status==\"MUTED\"),\nby: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize start = takeLast(Muted), end = takeFirst(Muted)\n| fields delta=end-start\n| fields `Mute delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Mute delta","categoryAxisLabel":"Mute delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Mute delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Mute delta"},"displayedFields":["Mute delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"57":{"type":"data","title":"","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| sort timestamp, direction:\"descending\"\n| summarize {\n  OpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n  ResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n  MutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\n  ResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\n  MuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.id}\n| fieldsAdd\n  Status=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n               else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n               else:\"OPEN\"))\n| summarize\n  Resolved=countIf(Status==\"RESOLVED\")\n| fields Resolved=if(Resolved>0,Resolved,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Resolved","categoryAxisLabel":"Resolved","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":true,"label":"","autoscale":false,"alignment":"start","prefixIcon":"SecurityResolvedIcon","recordField":"Resolved"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Resolved"},"displayedFields":["Resolved"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"58":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| sort timestamp, direction:\"descending\"\n  | summarize {\n    OpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n    ResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n    MutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\n    ResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\n    MuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.display_id, bin(timestamp,1h),alias:timestamp}\n| fieldsAdd\n  Status=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n  else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n  else:\"OPEN\"))\n| summarize\n  Resolved=countIf(Status==\"RESOLVED\"),\nby: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize start = takeLast(Resolved), end = takeFirst(Resolved)\n| fields delta=end-start\n| fields `Resolved delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Resolved delta","categoryAxisLabel":"Resolved delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Resolved delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Resolved delta"},"displayedFields":["Resolved delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"59":{"type":"data","title":"Resolved vulnerability count","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| sort timestamp, direction:\"descending\"\n| summarize {\n  OpenEntities=countIf(vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n  ResolvedEntities=countIf(vulnerability.resolution.status==\"RESOLVED\" AND vulnerability.mute.status==\"NOT_MUTED\"),\n  MutedEntities=countIf(vulnerability.mute.status==\"MUTED\"),\n  ResolutionStatus=takeFirst(vulnerability.parent.resolution.status),\n  MuteStatus=takeFirst(vulnerability.parent.mute.status)\n}, by: {vulnerability.id, bin(timestamp,1h),alias:timestamp}\n| fieldsAdd\nStatus=if((OpenEntities==0 AND ResolvedEntities==0 AND MutedEntities>0) OR MuteStatus==\"MUTED\",\"MUTED\",\n             else:if((OpenEntities==0 AND ResolvedEntities>0) OR ResolutionStatus==\"RESOLVED\",\"RESOLVED\",\n             else:\"OPEN\"))\n| summarize\nResolved=countIf(Status==\"RESOLVED\"),\nby: {timestamp}\n| sort timestamp, direction:\"descending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":false,"position":"right"},"seriesOverrides":[{"seriesId":"Resolved","override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-03-default, #009e8c)","Hover":"var(--dt-colors-charts-categorical-color-03-hover, #008071)","Active":"var(--dt-colors-charts-categorical-color-03-active, #006156)","DefaultTransparent":"var(--dt-colors-charts-categorical-color-03-default-transparent, #008771cc)","HoverTransparent":"var(--dt-colors-charts-categorical-color-03-hover-transparent, #005e50cc)","ActiveTransparent":"var(--dt-colors-charts-categorical-color-03-active-transparent, #00322bcc)"}}},{"seriesId":"Muted","override":{"color":{"Default":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-default, #5d687e)","Hover":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-hover, #4a5164)","Active":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-active, #363d49)","DefaultTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-default-transparent, #384560cc)","HoverTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-hover-transparent, #1f293fcc)","ActiveTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-active-transparent, #070f1ecc)"}}},{"seriesId":"Open","override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #d50b34)","Hover":"var(--dt-colors-charts-categorical-color-12-hover, #b30024)","Active":"var(--dt-colors-charts-categorical-color-12-active, #7e071d)","DefaultTransparent":"var(--dt-colors-charts-categorical-color-12-default-transparent, #c5000ccc)","HoverTransparent":"var(--dt-colors-charts-categorical-color-12-hover-transparent, #83000fcc)","ActiveTransparent":"var(--dt-colors-charts-categorical-color-12-active-transparent, #140000cc)"}}}],"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["Resolved"],"leftAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Resolved","sparklineSettings":{"isVisible":true,"showTicks":false}},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Resolved","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Davis Security Score","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"60":{"type":"markdown","title":"","content":"### Vulnerability classification"},"61":{"type":"data","title":"Vulnerabilities by stack level","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| sort timestamp, direction:\"descending\"\n| summarize\n  {\n    vulnerability.stack=takeFirst(vulnerability.stack)\n  }, by: {vulnerability.id}\n| fields\nvulnerability.stack=if(vulnerability.stack==\"CODE_LIBRARY\",\"Library\",\n                else:if(vulnerability.stack==\"SOFTWARE\",\"Software runtime\",\n                else:if(vulnerability.stack==\"CONTAINER_ORCHESTRATION\", \"Container runtime\")))\n| summarize count(), by:{vulnerability.stack}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"pieChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","colorPalette":"categorical","circleChartSettings":{"hideLabels":false,"groupingThresholdType":"relative"},"legend":{"hidden":false,"position":"auto"},"categoricalBarChartSettings":{"categoryAxisLabel":"vulnerability.stack","valueAxisLabel":"count()","layout":"horizontal","categoryAxis":"vulnerability.stack","valueAxis":["count()"],"tooltipVariant":"single"},"truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"vulnerability.stack"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{"value":"count()"},"displayedFields":["vulnerability.stack"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count()","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"62":{"type":"data","title":"Vulnerabilities by type","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n| sort timestamp, direction:\"descending\"\n| summarize\n{vulnerability.type=takeFirst(vulnerability.type)},\nby: {vulnerability.id}\n| summarize\nvulnerabilities=count(), by:{vulnerability.type}\n| sort vulnerabilities,direction:\"descending\"\n|limit 5","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","colorPalette":"categorical","circleChartSettings":{"hideLabels":false,"groupingThresholdType":"relative"},"legend":{"hidden":false,"position":"auto"},"categoricalBarChartSettings":{"categoryAxisLabel":"","valueAxisLabel":"Number","layout":"horizontal","categoryAxisTickLayout":"horizontal","categoryAxis":"vulnerability.type","valueAxis":"vulnerabilities"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"vulnerability.type"},"table":{"rowDensity":"condensed","enableLineWrap":false,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{"value":"vulnerabilities"},"displayedFields":["vulnerability.type"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"vulnerabilities","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"63":{"type":"data","title":"Vulnerabilities (sorted by status, risk, Davis assessment)","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n\n// now summarize on the vulnerability level\n| summarize\n{\n  vulnerability.parent.first_seen=takeFirst(vulnerability.parent.first_seen),\n  vulnerability.parent.resolution.status=takeFirst(vulnerability.parent.resolution.status),\n  vulnerability.parent.mute.status=takeFirst(vulnerability.parent.mute.status),\n  vulnerability.title=takeFirst(vulnerability.title),\n  vulnerability.references.cve=takeFirst(vulnerability.references.cve),\n  riskLevels=collectDistinct(if(vulnerability.mute.status == \"NOT_MUTED\" AND vulnerability.resolution.status == \"OPEN\", vulnerability.risk.level, else: null)),\n  vulnerability.risk.score=round(takeMax(if(vulnerability.mute.status == \"NOT_MUTED\" AND vulnerability.resolution.status == \"OPEN\", vulnerability.risk.score, else:0)),decimals:1),\n  affectedEntities=arraySize(collectDistinct(affected_entity.id)),\n  nonMutedEntities=countIf(vulnerability.mute.status==\"NOT_MUTED\"),\n  functionsInUse=countIf(vulnerability.davis_assessment.vulnerable_function_status==\"IN_USE\" AND\n    vulnerability.mute.status == \"NOT_MUTED\" AND\n    vulnerability.resolution.status == \"OPEN\"\n  ),\n  functionsNotAvailable=countIf(vulnerability.davis_assessment.vulnerable_function_status==\"NOT_AVAILABLE\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n  ),\n  exposurePublicNetwork=countIf(vulnerability.davis_assessment.exposure_status==\"PUBLIC_NETWORK\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n  ),\n  exposureNotAvailable=countIf(vulnerability.davis_assessment.exposure_status==\"NOT_AVAILABLE\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n  ),\n  exploitAvailable=countIf(vulnerability.davis_assessment.exploit_status==\"AVAILABLE\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n  ),\n  reachableDataAssets=countIf(vulnerability.davis_assessment.data_assets_status==\"REACHABLE\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n  ),\n  reachableDataAssetsNotAvailable=countIf(vulnerability.davis_assessment.data_assets_status==\"NOT_AVAILABLE\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n  )\n},\nby: {vulnerability.display_id}\n| fieldsAdd\n  vulnerability.risk.level=if(in(\"CRITICAL\", riskLevels),\"CRITICAL\",\n                                     else:if(in(\"HIGH\", riskLevels),\"HIGH\",\n                                     else:if(in(\"MEDIUM\", riskLevels),\"MEDIUM\",\n                                     else:\"LOW\"))),\n   status=if(vulnerability.parent.resolution.status==\"RESOLVED\",\"RESOLVED\",\n   else:if(nonMutedEntities==0 OR vulnerability.parent.mute.status==\"MUTED\", \"MUTED\",\n   else:\"OPEN\"))\n| fields\n  vulnerability.display_id,\n  Title=vulnerability.title,\n  CVE=if(arraySize(vulnerability.references.cve)>0,vulnerability.references.cve,else:\"-\"),\n  Status=if(status==\"RESOLVED\",\"âœ… Resolved\", else:if(status==\"MUTED\", \"âš« Muted (OPEN)\", else:\"ðŸ”´ Open\")),\n  DSS=concat(vulnerability.risk.level,\" (\",vulnerability.risk.score,\")\"),\n  vulnerability.risk.score,\n  status_sort=if(status==\"RESOLVED\",3,else:if(status==\"MUTED\",2,else:1)),\n  vulnerability.parent.first_seen,\n`# Function in use` = functionsInUse,\n`# Affected entities` = affectedEntities,\n`Vulnerable functions`=if(functionsInUse>0,concat(\"â—\",\"In use\"),else:if(functionsNotAvailable>0,\"Not available\",else:\"Not in use\")),\n`# Exposure to internet` = exposurePublicNetwork,\n`Public internet exposure`=if(exposurePublicNetwork>0,concat(\"â—\",\"Public network\"),else:if(exposureNotAvailable>0,\"Not available\",else:\"Not detected\")),\n`# Exploit published` = exploitAvailable,\n`Public exploit`=if(exploitAvailable>0,concat(\"â—\",\"Published\"),else:\"None published\"),\n`# Reachable databases` = reachableDataAssets,\n`Reachable data assets`=if(reachableDataAssets>0,concat(\"â—\",\"Within range\"),else:if(reachableDataAssetsNotAvailable>0,\"Not available\", else:\"None within range\"))\n| sort   status_sort, {vulnerability.risk.score, direction:\"descending\"}, {`# Function in use`, direction:\"descending\"},\n{`# Exposure to internet`, direction:\"descending\"}, {`# Exploit published`, direction:\"descending\"},\n{`# Reachable databases`, direction:\"descending\"}, {`# Affected entities`,direction:\"descending\"}, {vulnerability.parent.first_seen,direction:\"descending\"}\n| fieldsRemove status_sort, vulnerability.risk.score, vulnerability.parent.first_seen, `# Function in use`,`# Reachable databases`,`# Exposure to internet`,`# Exploit published`, `# Affected entities`","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"vulnerability.display_id","categoryAxisLabel":"vulnerability.display_id","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"vulnerability.display_id"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"vulnerability.display_id"},"displayedFields":["vulnerability.display_id","Title","CVE","Status","DSS","Vulnerable functions","Public internet exposure","Public exploit","Reachable data assets"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["External id"]],"firstVisibleRowIndex":0}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"64":{"type":"markdown","title":"","content":"## ðŸŽ¯ Environment analysis\n---\nIn-depth examination of affected entities and related entities in your environment in the context of the selected vulnerabilities. __Note__: _Change_ marks changes occurred within the set timeframe."},"65":{"type":"markdown","title":"","content":"### Affected entities\nEntities where the vulnerability was discovered, thus directly affected by the vulnerability."},"66":{"type":"data","title":"Process groups","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id,vulnerability.mute.status,vulnerability.resolution.status}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\naffected_entity.type=takeAny(affected_entity.type),\nby: {affected_entity.id}\n| summarize\n`Affected process groups`=countIf(affected_entity.type==\"PROCESS_GROUP\")\n| fields `Affected process groups`=if(`Affected process groups`>0,`Affected process groups`,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"start","recordField":"Affected process groups"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Affected process groups","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"67":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| sort timestamp, direction:\"descending\"\n| summarize\n{affected_entity.type=takeFirst(affected_entity.type)},\nby: {timestamp=bin(timestamp, 1h), affected_entity.id}\n// end of latest snapshot fetch\n| summarize {\n`Process groups`=countIf(affected_entity.type==\"PROCESS_GROUP\"),\n`Hosts`=countIf(affected_entity.type==\"HOST\")\n},\nby: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\nstart=takeLast(`Process groups`),\nend=takeFirst(`Process groups`)\n| fields delta=end-start\n| fields `Process groups delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Process groups delta","categoryAxisLabel":"Process groups delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Process groups delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Process groups delta"},"displayedFields":["Process groups delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"68":{"type":"data","title":"Affected entities count by type","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| sort timestamp, direction:\"descending\"\n| summarize\n{affected_entity.type=takeFirst(affected_entity.type)},\nby: {timestamp=bin(timestamp, 1h), affected_entity.id}\n// end of latest snapshot fetch\n| summarize {\n`Process groups`=countIf(affected_entity.type==\"PROCESS_GROUP\"),\n`Hosts`=countIf(affected_entity.type==\"HOST\")\n},\nby: {timestamp}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":false,"position":"auto"},"leftYAxisSettings":{"label":"","min":0},"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["Process groups","Hosts"],"leftAxisDimensions":[],"rightAxisValues":[]},"seriesOverrides":[{"seriesId":"Total affected entities","override":{"color":{"Default":"var(--dt-colors-charts-categorical-themed-blue-steel-color-05-default, #638ecf)","Hover":"var(--dt-colors-charts-categorical-themed-blue-steel-color-05-hover, #4e72a6)","Active":"var(--dt-colors-charts-categorical-themed-blue-steel-color-05-active, #3b567d)"}}},{"seriesId":"Exposted entities","override":{"color":"#b3007d"}}]},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Process groups","rangeAxis":""},{"valueAxis":"Hosts","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["Affected entities"]],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"69":{"type":"data","title":"Hosts","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id,vulnerability.mute.status,vulnerability.resolution.status}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\naffected_entity.type=takeAny(affected_entity.type),\nby: {affected_entity.id}\n| summarize\n`Affected hosts`=countIf(affected_entity.type==\"HOST\")\n| fields `Affected hosts`=if(`Affected hosts`>0,`Affected hosts`,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"start","recordField":"Affected hosts"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Affected hosts","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"70":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| sort timestamp, direction:\"descending\"\n| summarize\n{\naffected_entity.type=takeFirst(affected_entity.type)\n},\nby: {timestamp=bin(timestamp, 1h), affected_entity.id}\n// end of latest snapshot fetch\n| summarize {\n`Process groups`=countIf(affected_entity.type==\"PROCESS_GROUP\"),\n`Hosts`=countIf(affected_entity.type==\"HOST\")\n},\nby: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\nstart=takeLast(`Hosts`),\nend=takeFirst(`Hosts`)\n| fields delta=end-start\n| fields `Hosts delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Hosts delta","categoryAxisLabel":"Hosts delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Hosts delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Hosts delta"},"displayedFields":["Hosts delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"71":{"type":"markdown","title":"","content":"#### Number of entities with:"},"72":{"type":"data","title":"Public internet exposure","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id,vulnerability.mute.status,vulnerability.resolution.status}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{`Internet exposure`=countIf(vulnerability.davis_assessment.exposure_status==\"PUBLIC_NETWORK\")},\nby: {affected_entity.id}\n| summarize\n`With internet exposure`=countIf(`Internet exposure`>0)\n| fields `With internet exposure`=if(`With internet exposure`>0,`With internet exposure`,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"PublicExposureIcon","alignment":"start","recordField":"With internet exposure"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"With internet exposure","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"73":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{`Internet exposure`=countIf(vulnerability.davis_assessment.exposure_status==\"PUBLIC_NETWORK\")},\nby: {timestamp, affected_entity.id} // summarize vulnerabilities per affected entity\n| summarize\n{`Exposed`=countIf(`Internet exposure`>0)},\nby: {timestamp} // summarize them per timestamp (snapshot)\n| sort timestamp, direction:\"descending\"\n| summarize\n{`Exposed`=takeFirst(`Exposed`)},\nby: {bin(timestamp, 1h),alias:timestamp} // take the last snapshot of each hour\n| sort timestamp, direction:\"descending\"\n| summarize\nstart=takeLast(`Exposed`),\nend=takeFirst(`Exposed`)\n| fields delta=end-start\n| fields `Exposed delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Exposed delta","categoryAxisLabel":"Exposed delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Exposed delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Exposed delta"},"displayedFields":["Exposed delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"74":{"type":"data","title":"Affected entities with public internet exposure","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n{`Internet exposure`=countIf(vulnerability.davis_assessment.exposure_status==\"PUBLIC_NETWORK\")},\nby: {timestamp, affected_entity.id} // summarize vulnerabilities per affected entity\n| summarize\n{`Exposed`=countIf(`Internet exposure`>0)},\nby: {timestamp} // summarize them per timestamp (snapshot)\n| sort timestamp, direction:\"descending\"\n| summarize\n{`Public internet expusure`=takeFirst(`Exposed`)},\nby: {bin(timestamp, 1h),alias:timestamp} // take the last snapshot of each hour\n| sort timestamp, direction:\"descending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":false,"position":"auto"},"leftYAxisSettings":{"label":"","min":0},"seriesOverrides":[{"seriesId":"Total affected entities","override":{"color":{"Default":"var(--dt-colors-charts-categorical-themed-blue-steel-color-05-default, #638ecf)","Hover":"var(--dt-colors-charts-categorical-themed-blue-steel-color-05-hover, #4e72a6)","Active":"var(--dt-colors-charts-categorical-themed-blue-steel-color-05-active, #3b567d)"}}},{"seriesId":"Exposted entities","override":{"color":"#b3007d"}}],"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["Public internet expusure"],"leftAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Public internet expusure","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["Affected entities"]],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"75":{"type":"data","title":"Top 10 affected entities by Davis assessment","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| summarize\naffected_entity.name=takeFirst(affected_entity.name),\naffected_entity.type=takeFirst(affected_entity.type),\nvulnerability.risk.score=round(takeMax(vulnerability.risk.score),decimals:1),\nCritical=countIf(vulnerability.risk.level==\"CRITICAL\"),\nHigh=countIf(vulnerability.risk.level==\"HIGH\"),\nMedium=countIf(vulnerability.risk.level==\"MEDIUM\"),\nLow=countIf(vulnerability.risk.level==\"LOW\"),\n`# OPEN`=countIf(vulnerability.resolution.status==\"OPEN\"),\n`# RESOLVED`=countIf(vulnerability.resolution.status==\"RESOLVED\"),\n`# NOT-MUTED`=countIf(vulnerability.mute.status==\"NOT_MUTED\"),\n`# NOT-MUTED parents`=countIf(vulnerability.parent.mute.status==\"NOT_MUTED\"),\n`# Function in use`=countIf(\n  vulnerability.davis_assessment.vulnerable_function_status==\"IN_USE\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n),\n`# Function no data`=countIf(\n  vulnerability.davis_assessment.vulnerable_function_status==\"NOT_AVAILABLE\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n),\n`# Exposure to internet`=countIf(\n  vulnerability.davis_assessment.exposure_status==\"PUBLIC_NETWORK\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n),\n`# Exposure no data`=countIf(vulnerability.davis_assessment.exposure_status==\"NOT_AVAILABLE\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n),\n`# Exploit published`=countIf(vulnerability.davis_assessment.exploit_status==\"AVAILABLE\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n),\n`# Reachable databases`=countIf(vulnerability.davis_assessment.data_assets_status==\"REACHABLE\" AND\n  vulnerability.mute.status == \"NOT_MUTED\" AND\n  vulnerability.resolution.status == \"OPEN\"\n),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node),\nby: {affected_entity.id}\n| fieldsAdd\nvulnerability.resolution.status=if(`# OPEN`>0,\"AFFECTED\",else:\"RESOLVED\"),\nvulnerability.mute.status=if(`# NOT-MUTED`==0 OR `# NOT-MUTED parents`==0,\"MUTED\",else:\"NOT_MUTED\"),\nvulnerability.risk.level=if(Critical>0,\"CRITICAL\",\n                                     else:if(High>0,\"HIGH\",\n                                     else:if(Medium>0,\"MEDIUM\",\n                                     else:\"LOW\")))\n| fields\ndt.source_entity=affected_entity.id,\nName=affected_entity.name,\nType=affected_entity.type,\nstatus_sort=if(vulnerability.resolution.status==\"RESOLVED\",3,else:if( vulnerability.mute.status==\"MUTED\",2,else:1)),\nStatus=if(vulnerability.mute.status==\"MUTED\",concat(\"âš«\",\" Muted (\",vulnerability.resolution.status,\")\"),\n       else:if(`# OPEN`==0, concat(\"âœ…\",\"Resolved\"),\n            else:concat(\"ðŸ”´\",\" Affected\"))),\n`# Function in use`,\n`Vulnerable functions`=if(`# Function in use`>0,concat(\"â—\",\"In use\"),else:if(`# Function no data`>0,\"Not available\",else:\"Not in use\")),\n`# Exposure to internet`,\n`Public internet exposure`=if(`# Exposure to internet`>0,concat(\"â—\",\"Public network\"),else:if(`# Exposure no data`>0,\"Not available\",else:\"Not detected\")),\n`# Exploit published`,\n`Public exploit`=if(`# Exploit published`>0,concat(\"â—\",\"Published\"),else:\"None published\"),\n`# Reachable databases`,\n`Reachable data assets`=if(`# Reachable databases`>0,concat(\"â—\",\"Within range\"), else:\"None within range\"),\nvulnerability.risk.score,\ndt.entity.process_group=dt.entity.process_group,\ndt.entity.host=dt.entity.host,\ndt.entity.kubernetes_node=dt.entity.kubernetes_node\n| sort   status_sort, {vulnerability.risk.score, direction:\"descending\"}, {`# Function in use`, direction:\"descending\"},\n{`# Exposure to internet`, direction:\"descending\"}, {`# Exploit published`, direction:\"descending\"},\n{`# Reachable databases`, direction:\"descending\"}\n| fieldsRemove status_sort, vulnerability.risk.score, `# Function in use`,`# Reachable databases`,`# Exposure to internet`,`# Exploit published`\n| limit 10","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"dt.source_entity","categoryAxisLabel":"dt.source_entity","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"dt.source_entity"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["Name"]]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"dt.source_entity"},"displayedFields":["dt.source_entity","Name","Type","Status","Vulnerable functions","Public internet exposure","Public exploit","Reachable data assets","dt.entity.process_group"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["Affected process ids"],["Related services"],["Affected entity name"],["lookup.tags"],["Tags"]],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"76":{"type":"markdown","title":"","content":"### Related entities\nEntities that are connected to one of the affected entities, thus indirectly affected by the vulnerability."},"77":{"type":"data","title":"Applications","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.applications.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Applications`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"start","recordField":"Applications"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Applications","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["Related services"]]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"78":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.applications.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize start=takeLast(entities), end=takeFirst(entities)\n| fields delta=end-start\n| fields `Applications delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","legend":{"hidden":true,"position":"bottom"},"leftYAxisSettings":{"label":"","min":0,"scale":"linear"},"truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Applications delta","categoryAxisLabel":"Applications delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Applications delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Applications delta"},"displayedFields":["Applications delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"79":{"type":"data","title":"Applications over time","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.applications.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":true},"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["entities"],"leftAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":false,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["Related databases"]]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"entities","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"80":{"type":"data","title":"Databases","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.databases.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Databases`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"start","recordField":"Databases"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Databases","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"81":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.databases.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize start=takeLast(entities), end=takeFirst(entities)\n| fields delta=end-start\n| fields `Databases delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","legend":{"hidden":true,"position":"bottom"},"leftYAxisSettings":{"label":"","min":0,"scale":"linear"},"truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Databases delta","categoryAxisLabel":"Databases delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Databases delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Databases delta"},"displayedFields":["Databases delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"82":{"type":"data","title":"Databases over time","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.databases.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":true},"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["entities"],"leftAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":false,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["Related databases"]]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"entities","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"83":{"type":"data","title":"Services","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.services.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Services`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"start","recordField":"Services"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Services","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["Related services"]]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"84":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.services.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize start=takeLast(entities), end=takeFirst(entities)\n| fields delta=end-start\n| fields `Services delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","legend":{"hidden":true,"position":"bottom"},"leftYAxisSettings":{"label":"","min":0,"scale":"linear"},"truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Services delta","categoryAxisLabel":"Services delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Services delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Services delta"},"displayedFields":["Services delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"85":{"type":"data","title":"Services over time","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.services.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":true},"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["entities"],"leftAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":false,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["Related services"]]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"entities","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"86":{"type":"data","title":"Hosts","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.hosts.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Hosts`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"start","recordField":"Hosts"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Hosts","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"87":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.hosts.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize start=takeLast(entities), end=takeFirst(entities)\n| fields delta=end-start\n| fields `Hosts delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","legend":{"hidden":true,"position":"bottom"},"leftYAxisSettings":{"label":"","min":0,"scale":"linear"},"truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Hosts delta","categoryAxisLabel":"Hosts delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Hosts delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Hosts delta"},"displayedFields":["Hosts delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"88":{"type":"data","title":"Hosts over time","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.hosts.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":true},"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["entities"],"leftAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":false,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["Related processes"]]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"entities","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"89":{"type":"data","title":"Kubernetes workloads","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.kubernetes_workloads.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Kubernetes workloads`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"start","recordField":"Kubernetes workloads"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Kubernetes workloads","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"90":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.kubernetes_workloads.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize start=takeLast(entities), end=takeFirst(entities)\n| fields delta=end-start\n| fields `Kubernetes workloads delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","legend":{"hidden":true,"position":"bottom"},"leftYAxisSettings":{"label":"","min":0,"scale":"linear"},"truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Kubernetes workloads delta","categoryAxisLabel":"Kubernetes workloads delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Kubernetes workloads delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Kubernetes workloads delta"},"displayedFields":["Kubernetes workloads delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"91":{"type":"data","title":"Kubernetes workloads over time","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.kubernetes_workloads.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":true},"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["entities"],"leftAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":false,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["Related hosts"]]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"entities","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"92":{"type":"data","title":"Kubernetes clusters","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.kubernetes_clusters.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize entities=takeLast(entities)\n| fields `Kubernetes clusters`=if(entities>0, entities,  else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"start","recordField":"Kubernetes clusters"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Kubernetes clusters","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[],"firstVisibleRowIndex":0}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"93":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.kubernetes_clusters.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"\n| summarize start=takeLast(entities), end=takeFirst(entities)\n| fields delta=end-start\n| fields `Clusters delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","legend":{"hidden":true,"position":"bottom"},"leftYAxisSettings":{"label":"","min":0,"scale":"linear"},"truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Clusters delta","categoryAxisLabel":"Clusters delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Clusters delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Clusters delta"},"displayedFields":["Clusters delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"94":{"type":"data","title":"Kubernetes clusters over time","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n// only consider open, not muted entities\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n// flatten arrays for deduplication\n| expand entities=related_entities.kubernetes_clusters.ids\n// count grouped, deduplicated values\n| summarize entities=arraySize(arrayRemoveNulls(collectDistinct(entities))), by:{timestamp=bin(timestamp, 1h)}\n// put timestamp in the right order\n| sort timestamp, direction:\"ascending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":true},"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["entities"],"leftAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":false,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["Related Kubernetes workloads"]]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"entities","rangeAxis":""}]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"95":{"type":"markdown","title":"","content":"## ðŸ“ƒ Code analysis\n---\nInsights into the usage of vulnerable components and functions. __Note__: _Change_ marks changes occurred within the set timeframe."},"96":{"type":"markdown","title":"","content":"### Software components"},"97":{"type":"data","title":"Software components","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id,vulnerability.resolution.status,vulnerability.mute.status}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\nComponents=countIf(isNotNull(affected_entity.vulnerable_component.id)),\nby: {affected_entity.vulnerable_component.id}\n| summarize\n`Software components`=countIf(Components>0)","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"start","prefixIcon":"CodeIcon","recordField":"Software components"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Software components","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"98":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| sort timestamp, direction:\"descending\"\n| summarize\n{\naffected_entity.vulnerable_component.id=takeFirst(affected_entity.vulnerable_component.id),\nvulnerability.davis_assessment.vulnerable_function_status=takeFirst(vulnerability.davis_assessment.vulnerable_function_status)\n},\nby: {timestamp=bin(timestamp, 1h), affected_entity.id, vulnerability.display_id}\n| summarize\nComponents=countIf(isNotNull(affected_entity.vulnerable_component.id)),\nby: {timestamp, affected_entity.vulnerable_component.id}\n| summarize\nComponents=countIf(Components>0),\nby:{timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\nstart=takeLast(Components),\nend=takeFirst(Components)\n| fields delta=end-start\n| fields `Components delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","legend":{"hidden":true,"position":"bottom"},"leftYAxisSettings":{"label":"","min":0,"scale":"linear"},"truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Components delta","categoryAxisLabel":"Components delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Components delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Components delta"},"displayedFields":["Components delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"99":{"type":"data","title":"Software component count by vulnerable functions usage status","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter isNotNull(affected_entity.vulnerable_component.id)\n| sort timestamp, direction:\"descending\"\n| summarize\n{\naffected_entity.vulnerable_component.id=takeFirst(affected_entity.vulnerable_component.id),\nvulnerability.vulnerable_function_status=takeFirst(vulnerability.davis_assessment.vulnerable_function_status)\n},\nby: {timestamp=bin(timestamp, 1h), affected_entity.id, vulnerability.display_id}\n| summarize\n`In use`=countIf(vulnerability.vulnerable_function_status==\"IN_USE\" AND isNotNull(affected_entity.vulnerable_component.id)),\n`Not in use`=countIf(vulnerability.vulnerable_function_status==\"NOT_IN_USE\" AND isNotNull(affected_entity.vulnerable_component.id)),\n`No data`=countIf(vulnerability.vulnerable_function_status==\"NOT_AVAILABLE\" AND isNotNull(affected_entity.vulnerable_component.id)),\nby: {timestamp, affected_entity.vulnerable_component.id}\n| summarize\n{`In use`=countIf(`In use`>0),\n`Not in use`=countIf(`In use`==0 AND `Not in use`>0),\n`Not available`=countIf(`In use`==0 AND `Not in use`==0 AND `No data`>0)},\nby:{timestamp}\n| sort timestamp, direction:\"descending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":false,"position":"auto"},"leftYAxisSettings":{"label":"","min":0},"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["In use","Not in use","Not available"],"leftAxisDimensions":[],"rightAxisValues":[]},"seriesOverrides":[{"seriesId":["No data"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-default, #5d687e)","Hover":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-hover, #4a5164)","Active":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-active, #363d49)","DefaultTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-default-transparent, #384560cc)","HoverTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-hover-transparent, #1f293fcc)","ActiveTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-active-transparent, #070f1ecc)"}}},{"seriesId":["Not in use"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #0d9c29)","Hover":"var(--dt-colors-charts-categorical-color-09-hover, #0a7b20)","Active":"var(--dt-colors-charts-categorical-color-09-active, #075f19)","DefaultTransparent":"var(--dt-colors-charts-categorical-color-09-default-transparent, #008500cc)","HoverTransparent":"var(--dt-colors-charts-categorical-color-09-hover-transparent, #005905cc)","ActiveTransparent":"var(--dt-colors-charts-categorical-color-09-active-transparent, #003112cc)"}}},{"seriesId":["In use"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #d50b34)","Hover":"var(--dt-colors-charts-categorical-color-12-hover, #b30024)","Active":"var(--dt-colors-charts-categorical-color-12-active, #7e071d)","DefaultTransparent":"var(--dt-colors-charts-categorical-color-12-default-transparent, #c5000ccc)","HoverTransparent":"var(--dt-colors-charts-categorical-color-12-hover-transparent, #83000fcc)","ActiveTransparent":"var(--dt-colors-charts-categorical-color-12-active-transparent, #140000cc)"}}}]},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"In use","rangeAxis":""},{"valueAxis":"Not in use","rangeAxis":""},{"valueAxis":"Not available","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["Affected entities"]],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"100":{"type":"markdown","title":"","content":"##### Number of software components with:"},"101":{"type":"data","title":"Vulnerable functions in use","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\nComponents=countIf(vulnerability.davis_assessment.vulnerable_function_status==\"IN_USE\" AND isNotNull(affected_entity.vulnerable_component.id)),\nby: {affected_entity.vulnerable_component.id}\n| summarize\n`With function in use`=countIf(Components>0)","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"VulnerableFunctionIcon","alignment":"start","recordField":"With function in use"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"With function in use","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"102":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| sort timestamp, direction:\"descending\"\n| summarize\n{\naffected_entity.vulnerable_component.id=takeFirst(affected_entity.vulnerable_component.id),\nvulnerability.vulnerable_function_status=takeFirst(vulnerability.davis_assessment.vulnerable_function_status)\n},\nby: {timestamp=bin(timestamp, 1h), affected_entity.id, vulnerability.display_id}\n| summarize\nComponents=countIf(vulnerability.vulnerable_function_status==\"IN_USE\" AND isNotNull(affected_entity.vulnerable_component.id)),\nby: {timestamp, affected_entity.vulnerable_component.id}\n| summarize\nComponents=countIf(Components>0),\nby:{timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\nstart=takeLast(Components),\nend=takeFirst(Components)\n| fields delta=end-start\n| fields `Function usage delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Function usage delta","categoryAxisLabel":"Function usage delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Function usage delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Function usage delta"},"displayedFields":["Function usage delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"103":{"type":"data","title":"Vulnerable components","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter isNotNull(affected_entity.vulnerable_component.id)\n//add ownership information\n| lookup [\nfetch dt.entity.process_group\n| fieldsAdd tags\n| parse toString(tags), \"LD ('owner:'|'owner\\\\\\\\:') (SPACE)? LD:Team ('\\\"')\"\n], sourceField:affected_entity.id, lookupField:id, fields: {Team}\n| fieldsAdd Team=if(isNotNull(Team),Team,else:\"-\")\n// end of adding ownership info\n| summarize\n`# Affected entities`=arraySize(collectDistinct(affected_entity.id)),\n`Component name`=takeFirst(affected_entity.vulnerable_component.name),\n`# Function usages` = countIf(vulnerability.davis_assessment.vulnerable_function_status == \"IN_USE\"),\n`# Function not in use` = countIf(vulnerability.davis_assessment.vulnerable_function_status == \"NOT_IN_USE\"),\n`Teams`=takeFirst(Team),\nby: {affected_entity.vulnerable_component.id, alias:`Component id`}\n| summarize\n`Component name`=takeFirst(`Component name`),\n`# Affected entities`=takeFirst(`# Affected entities`),\n`# Function usages`=takeFirst(`# Function usages`),\n`# Function not in use`=takeFirst(`# Function not in use`),\n`Teams`=collectDistinct(`Teams`),\nby: {`Component id`}\n| fields\ndt.entity.software_component=`Component id`,\nName=`Component name`,\n`Owner team`=Teams,\n`Affected entities`=`# Affected entities`,\n`Vulnerable functions`=if(`# Function usages`>0,concat(\"â—\",\"In use\"),else:if(`# Function not in use`>0,\"Not in use\",else:\"Not available\"))\n| sort `Vulnerable functions`, direction:\"descending\", `Affected entities`, direction:\"descending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"dt.entity.software_component","categoryAxisLabel":"dt.entity.software_component","valueAxis":["Affected entities"],"valueAxisLabel":"Affected entities","tooltipVariant":"single"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"dt.entity.software_component"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{"value":"Affected entities"},"displayedFields":["dt.entity.software_component","Name","Vulnerable functions"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Affected entities","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["Affected process ids"]],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"104":{"type":"markdown","title":"","content":"### Vulnerable functions"},"105":{"type":"data","title":"Vulnerable functions","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id,vulnerability.mute.status,vulnerability.resolution.status}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize `Functions in use`=collectDistinct(affected_entity.vulnerable_functions)\n| expand `Functions in use`\n| summarize `Functions in use`=collectDistinct(`Functions in use`)\n| fields `Functions in use`=arraySize(arrayRemoveNulls(`Functions in use`))\n| fields `Functions in use`=if(`Functions in use`>0,`Functions in use`,else:\"-\")","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"prefixIcon":"VulnerableFunctionIcon","alignment":"start","recordField":"Functions in use"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Functions in use","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"106":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize `Functions in use`=collectDistinct(affected_entity.vulnerable_functions),\nby: {timestamp}\n| expand `Functions in use`\n| summarize `Functions in use`=collectDistinct(`Functions in use`),\nby: {timestamp}\n| fields timestamp, `Functions in use`=arraySize(arrayRemoveNulls(`Functions in use`))\n| sort timestamp, direction:\"descending\"\n| summarize `Functions in use`=takeFirst(`Functions in use`),\nby:{{timestamp=bin(timestamp,1h)}}\n| sort timestamp, direction:\"descending\"\n| summarize\nstart=takeLast(`Functions in use`),\nend=takeFirst(`Functions in use`)\n| fields delta=end-start\n| fields `Function delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Function delta","categoryAxisLabel":"Function delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Function delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Function delta"},"displayedFields":["Function delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"107":{"type":"data","title":"Vulnerable functions in use count over time","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| sort timestamp, direction:\"descending\"\n| summarize `Functions in use`=takeFirst(affected_entity.vulnerable_functions),\nby: {timestamp=bin(timestamp,1h), affected_entity.id, vulnerability.id}\n| summarize `Functions in use`=collectDistinct(`Functions in use`),\nby: {timestamp}\n| expand `Functions in use`\n| summarize `Functions in use`=collectDistinct(`Functions in use`),\nby: {timestamp}\n| fields timestamp, `In use`=arraySize(arrayRemoveNulls(`Functions in use`))\n| sort timestamp, direction:\"descending\"","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"hidden":false,"position":"auto"},"leftYAxisSettings":{"label":"","min":0,"scale":"linear","max":null},"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timestamp","leftAxisValues":["In use"],"leftAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"timestamp"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"In use","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"108":{"type":"markdown","title":"","content":"##### Number of affected entities with:"},"109":{"type":"data","title":"Vulnerable functions in use","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id,vulnerability.mute.status,vulnerability.resolution.status}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| summarize\n`# Function usages`=countIf(vulnerability.davis_assessment.vulnerable_function_status==\"IN_USE\"),\n`# Function not in use`=countIf(vulnerability.davis_assessment.vulnerable_function_status==\"NOT_IN_USE\"),\nby: {affected_entity.id}\n// now count the entities\n| summarize\n`Entities with function in use`=countIf(`# Function usages`>0)","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"start","prefixIcon":"VulnerableFunctionIcon","recordField":"Entities with function in use"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Entities with function in use","rangeAxis":""}]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"110":{"type":"data","title":"Change","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| sort timestamp, direction:\"descending\"\n| summarize\n{\nvulnerability.vulnerable_function_status=takeFirst(vulnerability.davis_assessment.vulnerable_function_status)\n},\nby: {timestamp=bin(timestamp, 1h), affected_entity.id, vulnerability.display_id}\n| summarize\n`Function in use`=countIf(vulnerability.vulnerable_function_status == \"IN_USE\"),\nby: {timestamp, affected_entity.id}\n| summarize\n`With functions in use`=countIf(`Function in use`>0),\nby: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\nstart=takeLast(`With functions in use`),\nend=takeFirst(`With functions in use`)\n| fields delta=end-start\n| fields `Entities delta`=if(delta>0,concat(delta,\"â†—ï¸\"),else:if(delta<0,concat(delta,\"â†˜ï¸\"),else:\"-\"))","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"Entities delta","categoryAxisLabel":"Entities delta","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"alignment":"center","recordField":"Entities delta"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"Entities delta"},"displayedFields":["Entities delta"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[]}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"111":{"type":"data","title":"Top 5 entities with vulnerable function in use","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter event.level==\"ENTITY\" // on entity level\n// filter only the latest snapshot data\n| dedup {vulnerability.id,affected_entity.id}, sort: { timestamp desc }\n// end of filtering for the latest snapshot\n| filter vulnerability.parent.resolution.status == $Status OR \"All\" == $Status\n| filter vulnerability.parent.mute.status == $MuteStatus OR \"All\" == $MuteStatus\n| filter in(vulnerability.stack,$StackLevel)\n| filter in(vulnerability.parent.risk.level,$RiskLevel)\n| filter vulnerability.resolution.status == \"OPEN\"\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.davis_assessment.vulnerable_function_status==\"IN_USE\"\n| summarize\n`Affected entity name`=takeFirst(affected_entity.name),\n`Internet exposure`=takeFirst(vulnerability.davis_assessment.exposure_status),\n`Reachable data assets`=takeFirst(vulnerability.davis_assessment.data_assets_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.process_group),\ndt.entity.kubernetes_node=takeFirst(dt.entity.process_group),\nby: {affected_entity.id}\n| fields\ndt.entity.process_group,\n`Affected entity name`,\n`Internet exposure`=if(`Internet exposure`==\"PUBLIC_NETWORK\",concat(\"â—\",\"Public network\"),else:if(`Internet exposure`==\"NOT_AVAILABLE\",\"Not available\", else:\"Not detected\")),\n`Reachable data assets`=if(arraySize(toArray(`Reachable data assets`))>0,concat(\"â—\",\"Within range\"), else:\"None within range\")\n| sort `Internet exposure`, `Reachable data assets`, direction:\"descending\"\n//add ownership information\n| lookup [\nfetch dt.entity.process_group\n| fieldsAdd tags\n| parse toString(tags), \"LD ('owner:'|'owner\\\\\\\\:') (SPACE)? LD:Team ('\\\"')\"\n| fieldsAdd Team\n], sourceField:dt.entity.process_group, lookupField:id, fields:{Team}\n| sort `Internet exposure`, direction:\"descending\", `Reachable data assets`, direction:\"descending\"\n| fields\ndt.entity.process_group,\nName=`Affected entity name`,\n`Owner team`=if(isNotNull(Team),Team,else:\"-\"),\n`Public internet exposure`=`Internet exposure`,\n`Reachable data assets`=`Reachable data assets`\n| limit 5","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"dt.entity.process_group","categoryAxisLabel":"dt.entity.process_group","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"dt.entity.process_group"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["Affected entity name"]]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"dt.entity.process_group"},"displayedFields":["dt.entity.process_group","Name","Owner team","Public internet exposure","Reachable data assets"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[]},"tableSettings":{"displayMode":"edit","lineWrapIds":[["Affected process ids"],["# Affected processes"]],"firstVisibleRowIndex":0},"singleValueSettings":{"showLabel":true,"suffix":"","recordField":"Affected Entities","autoscale":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},"layouts":{"0":{"x":1,"y":0,"w":4,"h":3},"1":{"x":5,"y":0,"w":13,"h":6},"2":{"x":18,"y":0,"w":5,"h":6},"3":{"x":1,"y":3,"w":4,"h":2},"4":{"x":0,"y":6,"w":24,"h":2},"5":{"x":1,"y":8,"w":6,"h":1},"6":{"x":8,"y":8,"w":8,"h":1},"7":{"x":17,"y":8,"w":6,"h":1},"8":{"x":1,"y":9,"w":6,"h":2},"9":{"x":8,"y":9,"w":8,"h":2},"10":{"x":17,"y":9,"w":6,"h":2},"11":{"x":1,"y":11,"w":6,"h":4},"12":{"x":8,"y":11,"w":4,"h":2},"13":{"x":12,"y":11,"w":2,"h":2},"14":{"x":14,"y":11,"w":2,"h":2},"15":{"x":17,"y":11,"w":3,"h":2},"16":{"x":20,"y":11,"w":3,"h":2},"17":{"x":8,"y":13,"w":8,"h":10},"18":{"x":17,"y":13,"w":3,"h":2},"19":{"x":20,"y":13,"w":3,"h":2},"20":{"x":1,"y":15,"w":6,"h":8},"21":{"x":17,"y":15,"w":6,"h":2},"22":{"x":17,"y":17,"w":6,"h":2},"23":{"x":17,"y":19,"w":3,"h":2},"24":{"x":20,"y":19,"w":3,"h":2},"25":{"x":17,"y":21,"w":6,"h":2},"26":{"x":1,"y":23,"w":22,"h":1},"27":{"x":0,"y":24,"w":24,"h":2},"28":{"x":1,"y":26,"w":22,"h":1},"29":{"x":1,"y":27,"w":22,"h":2},"30":{"x":1,"y":29,"w":5,"h":2},"31":{"x":6,"y":29,"w":2,"h":2},"32":{"x":8,"y":29,"w":15,"h":8},"33":{"x":1,"y":31,"w":5,"h":2},"34":{"x":6,"y":31,"w":2,"h":2},"35":{"x":1,"y":33,"w":5,"h":2},"36":{"x":6,"y":33,"w":2,"h":2},"37":{"x":1,"y":35,"w":5,"h":2},"38":{"x":6,"y":35,"w":2,"h":2},"39":{"x":1,"y":37,"w":22,"h":2},"40":{"x":1,"y":39,"w":5,"h":2},"41":{"x":6,"y":39,"w":2,"h":2},"42":{"x":8,"y":39,"w":15,"h":8},"43":{"x":1,"y":41,"w":5,"h":2},"44":{"x":6,"y":41,"w":2,"h":2},"45":{"x":1,"y":43,"w":5,"h":2},"46":{"x":6,"y":43,"w":2,"h":2},"47":{"x":1,"y":45,"w":5,"h":2},"48":{"x":6,"y":45,"w":2,"h":2},"49":{"x":0,"y":47,"w":24,"h":2},"50":{"x":1,"y":49,"w":22,"h":1},"51":{"x":1,"y":50,"w":7,"h":2},"52":{"x":8,"y":50,"w":15,"h":6},"53":{"x":1,"y":52,"w":4,"h":2},"54":{"x":5,"y":52,"w":3,"h":2},"55":{"x":1,"y":54,"w":4,"h":2},"56":{"x":5,"y":54,"w":3,"h":2},"57":{"x":1,"y":56,"w":4,"h":2},"58":{"x":5,"y":56,"w":3,"h":2},"59":{"x":8,"y":56,"w":15,"h":2},"60":{"x":1,"y":58,"w":22,"h":1},"61":{"x":1,"y":59,"w":7,"h":7},"62":{"x":8,"y":59,"w":15,"h":7},"63":{"x":1,"y":66,"w":22,"h":11},"64":{"x":0,"y":77,"w":24,"h":2},"65":{"x":1,"y":79,"w":22,"h":2},"66":{"x":1,"y":81,"w":5,"h":2},"67":{"x":6,"y":81,"w":2,"h":2},"68":{"x":8,"y":81,"w":15,"h":4},"69":{"x":1,"y":83,"w":5,"h":2},"70":{"x":6,"y":83,"w":2,"h":2},"71":{"x":1,"y":85,"w":22,"h":1},"72":{"x":1,"y":86,"w":5,"h":2},"73":{"x":6,"y":86,"w":2,"h":2},"74":{"x":8,"y":86,"w":15,"h":2},"75":{"x":1,"y":88,"w":22,"h":8},"76":{"x":1,"y":96,"w":22,"h":2},"77":{"x":1,"y":98,"w":5,"h":2},"78":{"x":6,"y":98,"w":2,"h":2},"79":{"x":8,"y":98,"w":15,"h":2},"80":{"x":1,"y":100,"w":5,"h":2},"81":{"x":6,"y":100,"w":2,"h":2},"82":{"x":8,"y":100,"w":15,"h":2},"83":{"x":1,"y":102,"w":5,"h":2},"84":{"x":6,"y":102,"w":2,"h":2},"85":{"x":8,"y":102,"w":15,"h":2},"86":{"x":1,"y":104,"w":5,"h":2},"87":{"x":6,"y":104,"w":2,"h":2},"88":{"x":8,"y":104,"w":15,"h":2},"89":{"x":1,"y":106,"w":5,"h":2},"90":{"x":6,"y":106,"w":2,"h":2},"91":{"x":8,"y":106,"w":15,"h":2},"92":{"x":1,"y":108,"w":5,"h":2},"93":{"x":6,"y":108,"w":2,"h":2},"94":{"x":8,"y":108,"w":15,"h":2},"95":{"x":0,"y":110,"w":24,"h":2},"96":{"x":1,"y":112,"w":22,"h":1},"97":{"x":1,"y":113,"w":4,"h":2},"98":{"x":5,"y":113,"w":3,"h":2},"99":{"x":8,"y":113,"w":15,"h":5},"100":{"x":1,"y":115,"w":7,"h":1},"101":{"x":1,"y":116,"w":4,"h":2},"102":{"x":5,"y":116,"w":3,"h":2},"103":{"x":1,"y":118,"w":22,"h":7},"104":{"x":1,"y":125,"w":22,"h":1},"105":{"x":1,"y":126,"w":4,"h":2},"106":{"x":5,"y":126,"w":3,"h":2},"107":{"x":8,"y":126,"w":15,"h":5},"108":{"x":1,"y":128,"w":7,"h":1},"109":{"x":1,"y":129,"w":4,"h":2},"110":{"x":5,"y":129,"w":3,"h":2},"111":{"x":1,"y":131,"w":22,"h":7}},"importedWithCode":false}