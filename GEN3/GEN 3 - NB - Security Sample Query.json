{"version":"5","defaultTimeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-07-10T14:11:10.621Z"},"to":{"type":"expression","normalized":"now","date":"2023-07-11T14:11:10.621Z"}}},"sections":[{"id":"01ac54fc-2d85-4961-8506-3a0220af8006","type":"markdown","markdown":"### Application Security Notebook \n\nOwner: TYara\nv2"},{"id":"9313598f-2308-467f-bf91-8fa93013ceba","type":"dql","title":"Count vulnerabilities by status","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{event.status=takeFirst(event.status)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| summarize \ncount(), by:{event.status} // event.status represents the combined status of vulnerability resolution and muting statuses","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-12T08:47:39.358Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:17:39.358Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative"},"colorPalette":"log-status"},"singleValue":{"showLabel":true,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0}},"result":{"code":200,"value":{"records":[{"event.status":"OPEN","count()":"78"},{"event.status":"RESOLVED","count()":"68"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"VULNERABILITY\"\n| sort timestamp, direction:\"descending\"\n| summarize by:{vulnerability.display_id}, takeFirst(event.status), alias:event.status\n| summarize by:{event.status}, count()","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{event.status=takeFirst(event.status)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| summarize \ncount(), by:{event.status} // event.status represents the combined status of vulnerability resolution and muting statuses","scannedRecords":3679,"dqlVersion":"V1_0","scannedBytes":1858375,"analysisTimeframe":{"start":"2023-08-07T14:30:33.996Z","end":"2023-08-07T15:00:33.996Z"},"locale":"","executionTimeMilliseconds":175,"notifications":[],"queryId":"59b3ce1e-7585-406f-97e7-8e183c51fa13","sampled":false}},"types":[{"mappings":{"event.status":{"type":"string"},"count()":{"type":"long"}},"indexRange":[0,1]}]},"notifications":[],"dateTime":"2023-08-07T15:00:33.995Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{event.status=takeFirst(event.status)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| summarize \ncount(), by:{event.status} // event.status represents the combined status of vulnerability resolution and muting statuses","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-12T08:47:39.358Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:17:39.358Z"}}}}},"visualization":"donutChart","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"height":325,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"55f3de39-a30d-41b2-a5f8-48ec3cc70a0f","type":"dql","title":"Count open vulnerabilities by risk level over time","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n| filter vulnerability.resolution.status==\"OPEN\" // filter for open vulnerabilities\n// first get the snapshots of each hour per vulnerability\n| sort timestamp, direction:\"descending\"\n| summarize {\nvulnerability.davis_assessment.level=takeFirst(vulnerability.davis_assessment.level),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)\n}, by: {vulnerability.display_id, timestamp=bin(timestamp,1h)}\n// aggregate per each timestamp\n| summarize {\nCritical=countIf((vulnerability.davis_assessment.level)==\"CRITICAL\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nHigh=countIf((vulnerability.davis_assessment.level)==\"HIGH\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nMedium=countIf((vulnerability.davis_assessment.level)==\"MEDIUM\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nLow=countIf((vulnerability.davis_assessment.level)==\"LOW\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nMuted=countIf((vulnerability.mute.status)==\"MUTED\") },\nby: {timestamp}\n| sort timestamp, direction:\"descending\"","timeframe":{"from":"now-1d","to":"now","details":{"from":{"type":"expression","normalized":"now-1d","date":"2023-07-09T16:01:52.124Z"},"to":{"type":"expression","normalized":"now","date":"2023-07-10T16:01:52.124Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"colorPalette":"vulnerability-risk-level","seriesOverrides":[{"seriesId":["Muted"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-default, #5d687e)","Hover":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-hover, #4a5164)","Active":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-active, #363d49)","DefaultTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-default-transparent, #384560cc)","HoverTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-hover-transparent, #1f293fcc)","ActiveTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-active-transparent, #070f1ecc)"}}}]},"singleValue":{"showLabel":true,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0}},"result":{"code":200,"value":{"records":[{"timestamp":"2023-08-07T16:00:00.000000000+02:00","Critical":"0","High":"52","Medium":"22","Low":"4","Muted":"0"},{"timestamp":"2023-08-07T15:00:00.000000000+02:00","Critical":"0","High":"9","Medium":"65","Low":"4","Muted":"0"},{"timestamp":"2023-08-07T14:00:00.000000000+02:00","Critical":"0","High":"52","Medium":"22","Low":"4","Muted":"0"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"VULNERABILITY\"\n| filter vulnerability.resolution.status == \"OPEN\"\n| sort timestamp, direction:\"descending\"\n| summarize by:{vulnerability.display_id, {bin(timestamp, 1h), alias:timestamp}}, {{takeFirst(vulnerability.davis_assessment.level), alias:vulnerability.davis_assessment.level}, {takeFirst(vulnerability.mute.status), alias:vulnerability.mute.status}}\n| summarize by:{timestamp}, {{countIf(vulnerability.davis_assessment.level == \"CRITICAL\" AND vulnerability.mute.status == \"NOT_MUTED\"), alias:Critical}, {countIf(vulnerability.davis_assessment.level == \"HIGH\" AND vulnerability.mute.status == \"NOT_MUTED\"), alias:High}, {countIf(vulnerability.davis_assessment.level == \"MEDIUM\" AND vulnerability.mute.status == \"NOT_MUTED\"), alias:Medium}, {countIf(vulnerability.davis_assessment.level == \"LOW\" AND vulnerability.mute.status == \"NOT_MUTED\"), alias:Low}, {countIf(vulnerability.mute.status == \"MUTED\"), alias:Muted}}\n| sort timestamp, direction:\"descending\"","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n| filter vulnerability.resolution.status==\"OPEN\" // filter for open vulnerabilities\n// first get the snapshots of each hour per vulnerability\n| sort timestamp, direction:\"descending\"\n| summarize {\nvulnerability.davis_assessment.level=takeFirst(vulnerability.davis_assessment.level),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)\n}, by: {vulnerability.display_id, timestamp=bin(timestamp,1h)}\n// aggregate per each timestamp\n| summarize {\nCritical=countIf((vulnerability.davis_assessment.level)==\"CRITICAL\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nHigh=countIf((vulnerability.davis_assessment.level)==\"HIGH\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nMedium=countIf((vulnerability.davis_assessment.level)==\"MEDIUM\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nLow=countIf((vulnerability.davis_assessment.level)==\"LOW\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nMuted=countIf((vulnerability.mute.status)==\"MUTED\") },\nby: {timestamp}\n| sort timestamp, direction:\"descending\"","scannedRecords":14527,"dqlVersion":"V1_0","scannedBytes":4416836,"analysisTimeframe":{"start":"2023-08-06T15:00:34.000Z","end":"2023-08-07T15:00:34.000Z"},"locale":"","executionTimeMilliseconds":170,"notifications":[],"queryId":"d722b391-08ef-4b02-b8ca-d244e49d848d","sampled":false}},"types":[{"mappings":{"timestamp":{"type":"timestamp"},"Critical":{"type":"long"},"High":{"type":"long"},"Medium":{"type":"long"},"Low":{"type":"long"},"Muted":{"type":"long"}},"indexRange":[0,2]}]},"notifications":[],"dateTime":"2023-08-07T15:00:33.999Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n| filter vulnerability.resolution.status==\"OPEN\" // filter for open vulnerabilities\n// first get the snapshots of each hour per vulnerability\n| sort timestamp, direction:\"descending\"\n| summarize {\nvulnerability.davis_assessment.level=takeFirst(vulnerability.davis_assessment.level),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)\n}, by: {vulnerability.display_id, timestamp=bin(timestamp,1h)}\n// aggregate per each timestamp\n| summarize {\nCritical=countIf((vulnerability.davis_assessment.level)==\"CRITICAL\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nHigh=countIf((vulnerability.davis_assessment.level)==\"HIGH\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nMedium=countIf((vulnerability.davis_assessment.level)==\"MEDIUM\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nLow=countIf((vulnerability.davis_assessment.level)==\"LOW\" AND (vulnerability.mute.status)==\"NOT_MUTED\"),\nMuted=countIf((vulnerability.mute.status)==\"MUTED\") },\nby: {timestamp}\n| sort timestamp, direction:\"descending\"","timeframe":{"from":"now-1d","to":"now","details":{"from":{"type":"expression","normalized":"now-1d","date":"2023-07-09T16:01:52.124Z"},"to":{"type":"expression","normalized":"now","date":"2023-07-10T16:01:52.124Z"}}}}},"visualization":"areaChart","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"height":450,"showInput":false,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"da69f8fd-2676-46ec-86ac-fa6f3ce86f6b","type":"dql","title":"Count vulnerability status change events over time","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATUS_CHANGE_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n| summarize {\nOpen=countIf(event.status==\"OPEN\"),\nResolved=countIf(event.status==\"RESOLVED\"),\nMuted=countIf(event.status==\"MUTED\")\n}, by:{timestamp=bin(timestamp, 1h)}","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-07-10T14:11:10.621Z"},"to":{"type":"expression","normalized":"now","date":"2023-07-11T14:11:10.621Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"colorPalette":"log-status","seriesOverrides":[{"seriesId":["Muted"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-default, #5d687e)","Hover":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-hover, #4a5164)","Active":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-active, #363d49)","DefaultTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-default-transparent, #384560cc)","HoverTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-hover-transparent, #1f293fcc)","ActiveTransparent":"var(--dt-colors-charts-categorical-themed-blue-steel-color-04-active-transparent, #070f1ecc)"}}},{"seriesId":["Resolved"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #0d9c29)","Hover":"var(--dt-colors-charts-categorical-color-09-hover, #0a7b20)","Active":"var(--dt-colors-charts-categorical-color-09-active, #075f19)","DefaultTransparent":"var(--dt-colors-charts-categorical-color-09-default-transparent, #008500cc)","HoverTransparent":"var(--dt-colors-charts-categorical-color-09-hover-transparent, #005905cc)","ActiveTransparent":"var(--dt-colors-charts-categorical-color-09-active-transparent, #003112cc)"}}},{"seriesId":["Open"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #d50b34)","Hover":"var(--dt-colors-charts-categorical-color-12-hover, #b30024)","Active":"var(--dt-colors-charts-categorical-color-12-active, #7e071d)","DefaultTransparent":"var(--dt-colors-charts-categorical-color-12-default-transparent, #c5000ccc)","HoverTransparent":"var(--dt-colors-charts-categorical-color-12-hover-transparent, #83000fcc)","ActiveTransparent":"var(--dt-colors-charts-categorical-color-12-active-transparent, #140000cc)"}}}]},"singleValue":{"showLabel":true,"label":"","autoscale":true,"sparklineSettings":{"showSparkline":false,"color":{"Default":"var(--dt-colors-charts-categorical-color-07-default, #004c52)","Hover":"var(--dt-colors-charts-categorical-color-07-hover, #003e42)","Active":"var(--dt-colors-charts-categorical-color-07-active, #002b2e)","DefaultTransparent":"var(--dt-colors-charts-categorical-color-07-default-transparent, #000c0dcc)","HoverTransparent":"var(--dt-colors-charts-categorical-color-07-hover-transparent, #000c)","ActiveTransparent":"var(--dt-colors-charts-categorical-color-07-active-transparent, #000c)"},"variant":"line","record":"none","showTicks":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{},"enableLineWrap":false}},"result":{"code":200,"value":{"records":[{"timestamp":"2023-12-04T00:00:00.000000000-06:00","Open":"1","Resolved":"0","Muted":"0"},{"timestamp":"2023-12-04T10:00:00.000000000-06:00","Open":"2","Resolved":"0","Muted":"0"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATUS_CHANGE_EVENT\"\n| filter event.level == \"VULNERABILITY\"\n| summarize by:{bin(timestamp, 1h), alias:timestamp}, {{countIf(event.status == \"OPEN\"), alias:Open}, {countIf(event.status == \"RESOLVED\"), alias:Resolved}, {countIf(event.status == \"MUTED\"), alias:Muted}}","timezone":"America/Chicago","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATUS_CHANGE_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n| summarize {\nOpen=countIf(event.status==\"OPEN\"),\nResolved=countIf(event.status==\"RESOLVED\"),\nMuted=countIf(event.status==\"MUTED\")\n}, by:{timestamp=bin(timestamp, 1h)}","scannedRecords":511601,"dqlVersion":"V1_0","scannedBytes":151596758,"analysisTimeframe":{"start":"2023-12-03T16:17:48.674Z","end":"2023-12-04T16:17:48.674Z"},"locale":"","executionTimeMilliseconds":54,"notifications":[],"queryId":"cf0677b7-37c5-45ba-8b2f-d69850c6d29f","sampled":false}},"types":[{"mappings":{"timestamp":{"type":"timestamp"},"Open":{"type":"long"},"Resolved":{"type":"long"},"Muted":{"type":"long"}},"indexRange":[0,1]}]},"notifications":[],"dateTime":"2023-12-04T16:17:48.672Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATUS_CHANGE_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n| summarize {\nOpen=countIf(event.status==\"OPEN\"),\nResolved=countIf(event.status==\"RESOLVED\"),\nMuted=countIf(event.status==\"MUTED\")\n}, by:{timestamp=bin(timestamp, 1h)}","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-07-10T14:11:10.621Z"},"to":{"type":"expression","normalized":"now","date":"2023-07-11T14:11:10.621Z"}}}}},"visualization":"barChart","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}},"showInput":false,"height":450,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}}},{"id":"0fea0432-5007-4d0a-94af-2d04b6d7a750","type":"dql","title":"Fetch open non-muted vulnerabilities by Davis Security Score","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.resolution.change_date=takeFirst(vulnerability.resolution.change_date),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status),\nvulnerability.davis_assessment.score=takeFirst(vulnerability.davis_assessment.score),\nvulnerability.davis_assessment.level=takeFirst(vulnerability.davis_assessment.level),\nvulnerability.title=takeFirst(vulnerability.title),\nvulnerability.external_id=takeFirst(vulnerability.external_id),\nvulnerability.references.cve=takeFirst(vulnerability.references.cve),\ntimestamp=takeFirst(timestamp)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\" // filter for open non-muted vulnerabilities\n| sort vulnerability.davis_assessment.score, direction:\"descending\"\n| fields \nvulnerability.display_id,\nTitle=vulnerability.title,\n`Davis Security Score`=concat(vulnerability.davis_assessment.level,\" (\",round(vulnerability.davis_assessment.score,decimals:1),\")\"),\nStatus=vulnerability.resolution.status,\n`Status date`=formatTimestamp(toTimestamp(vulnerability.resolution.change_date), format:\"MMM dd, HH:mm:ss\"),\n`CVE list`=substring(toString(vulnerability.references.cve), from:1, to:-1),\n`External id`=vulnerability.external_id","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-04T10:57:03.863Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-04T11:27:03.863Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0}},"result":{"code":200,"value":{"records":[{"vulnerability.display_id":"S-123","Title":"XML External Entity (XXE) Injection","Davis Security Score":"HIGH (8.3)","Status":"OPEN","Status date":"Aug 03, 21:24:28","CVE list":"CVE-2021-23926","External id":"SNYK-JAVA-ORGAPACHEXMLBEANS-1060048"},{"vulnerability.display_id":"S-138","Title":"CVE-2023-33127","Davis Security Score":"HIGH (8.1)","Status":"OPEN","Status date":"Aug 03, 22:15:28","External id":"CVE-2023-33127"},{"vulnerability.display_id":"S-141","Title":"Race Condition","Davis Security Score":"HIGH (8.1)","Status":"OPEN","Status date":"Aug 03, 22:15:28","External id":"CVE-2023-33170"},{"vulnerability.display_id":"S-136","Title":"CVE-2023-28260","Davis Security Score":"HIGH (7.8)","Status":"OPEN","Status date":"Aug 03, 22:15:28","External id":"CVE-2023-28260"},{"vulnerability.display_id":"S-126","Title":"CVE-2023-23919","Davis Security Score":"HIGH (7.5)","Status":"OPEN","Status date":"Aug 03, 21:27:28","External id":"CVE-2023-23919"},{"vulnerability.display_id":"S-146","Title":"Denial of Service (DoS)","Davis Security Score":"HIGH (7.5)","Status":"OPEN","Status date":"Aug 03, 22:16:28","CVE list":"CVE-2023-20883","External id":"SNYK-JAVA-ORGSPRINGFRAMEWORKBOOT-5564390"},{"vulnerability.display_id":"S-52","Title":"Denial of Service (DoS)","Davis Security Score":"HIGH (7.5)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36518","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-2421244"},{"vulnerability.display_id":"S-137","Title":"CVE-2023-33126","Davis Security Score":"HIGH (7.3)","Status":"OPEN","Status date":"Aug 03, 22:15:28","External id":"CVE-2023-33126"},{"vulnerability.display_id":"S-139","Title":"CVE-2023-33128","Davis Security Score":"HIGH (7.3)","Status":"OPEN","Status date":"Aug 03, 22:15:28","External id":"CVE-2023-33128"},{"vulnerability.display_id":"S-140","Title":"CVE-2023-33135","Davis Security Score":"HIGH (7.3)","Status":"OPEN","Status date":"Aug 03, 22:15:28","External id":"CVE-2023-33135"},{"vulnerability.display_id":"S-33","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-24750","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1009829"},{"vulnerability.display_id":"S-34","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-10650","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1047324"},{"vulnerability.display_id":"S-36","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-35490","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1052449"},{"vulnerability.display_id":"S-37","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-35491","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1052450"},{"vulnerability.display_id":"S-38","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-35728","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1054588"},{"vulnerability.display_id":"S-39","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36187","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056414"},{"vulnerability.display_id":"S-40","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36184","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056416"},{"vulnerability.display_id":"S-41","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36186","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056417"},{"vulnerability.display_id":"S-42","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36180","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056418"},{"vulnerability.display_id":"S-43","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36183","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056419"},{"vulnerability.display_id":"S-44","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36179","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056420"},{"vulnerability.display_id":"S-45","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36182","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056421"},{"vulnerability.display_id":"S-46","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36185","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056424"},{"vulnerability.display_id":"S-47","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36189","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056425"},{"vulnerability.display_id":"S-48","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36188","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056426"},{"vulnerability.display_id":"S-49","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-36181","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1056427"},{"vulnerability.display_id":"S-50","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2021-20190","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1061931"},{"vulnerability.display_id":"S-58","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2019-16335","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-467014"},{"vulnerability.display_id":"S-59","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2019-14540","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-467015"},{"vulnerability.display_id":"S-60","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-467016"},{"vulnerability.display_id":"S-61","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2019-16942","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-469674"},{"vulnerability.display_id":"S-62","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2019-16943","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-469676"},{"vulnerability.display_id":"S-63","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2019-17267","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-471943"},{"vulnerability.display_id":"S-64","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2019-17531","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-472980"},{"vulnerability.display_id":"S-65","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2019-20330","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-540500"},{"vulnerability.display_id":"S-66","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-8840","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-548451"},{"vulnerability.display_id":"S-67","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-9546,CVE-2020-9547,CVE-2020-9548","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-559094"},{"vulnerability.display_id":"S-68","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2019-14893,CVE-2019-14892","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-559106"},{"vulnerability.display_id":"S-69","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-10673","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-560762"},{"vulnerability.display_id":"S-70","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-10672","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-560766"},{"vulnerability.display_id":"S-71","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-10969","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-561362"},{"vulnerability.display_id":"S-72","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-10968","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-561373"},{"vulnerability.display_id":"S-73","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-11113","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-561585"},{"vulnerability.display_id":"S-74","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-11111","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-561586"},{"vulnerability.display_id":"S-75","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-11112","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-561587"},{"vulnerability.display_id":"S-76","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-11620","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-564887"},{"vulnerability.display_id":"S-77","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-11619","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-564888"},{"vulnerability.display_id":"S-78","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-14062","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-570625"},{"vulnerability.display_id":"S-79","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-14195","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-572300"},{"vulnerability.display_id":"S-80","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-14060","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-572314"},{"vulnerability.display_id":"S-81","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-14061","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-572316"},{"vulnerability.display_id":"S-82","Title":"Deserialization of Untrusted Data","Davis Security Score":"HIGH (7.0)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-24616","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-608664"},{"vulnerability.display_id":"S-118","Title":"Deserialization of Untrusted Data","Davis Security Score":"MEDIUM (6.5)","Status":"OPEN","Status date":"Aug 03, 21:14:28","CVE list":"CVE-2022-25647","External id":"SNYK-JAVA-COMGOOGLECODEGSON-1730327"},{"vulnerability.display_id":"S-144","Title":"Improper Access Control","Davis Security Score":"MEDIUM (6.5)","Status":"OPEN","Status date":"Aug 03, 22:16:28","CVE list":"CVE-2023-20860","External id":"SNYK-JAVA-ORGSPRINGFRAMEWORK-3369852"},{"vulnerability.display_id":"S-145","Title":"Allocation of Resources Without Limits or Throttling","Davis Security Score":"MEDIUM (6.5)","Status":"OPEN","Status date":"Aug 03, 22:16:28","CVE list":"CVE-2023-20863","External id":"SNYK-JAVA-ORGSPRINGFRAMEWORK-5422217"},{"vulnerability.display_id":"S-23","Title":"Regular Expression Denial of Service (ReDoS)","Davis Security Score":"MEDIUM (6.5)","Status":"OPEN","Status date":"Aug 03, 20:48:28","CVE list":"CVE-2022-25883","External id":"SNYK-JS-SEMVER-3247795"},{"vulnerability.display_id":"S-25","Title":"Prototype Poisoning","Davis Security Score":"MEDIUM (6.5)","Status":"OPEN","Status date":"Aug 03, 20:49:28","CVE list":"CVE-2022-24999","External id":"SNYK-JS-QS-3153490"},{"vulnerability.display_id":"S-35","Title":"XML External Entity (XXE) Injection","Davis Security Score":"MEDIUM (6.5)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-25649","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-1048302"},{"vulnerability.display_id":"S-98","Title":"Denial of Service (DoS)","Davis Security Score":"MEDIUM (6.5)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2023-24998","External id":"SNYK-JAVA-ORGAPACHETOMCAT-3326458"},{"vulnerability.display_id":"S-99","Title":"Denial of Service (DoS)","Davis Security Score":"MEDIUM (6.5)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2023-24998","External id":"SNYK-JAVA-ORGAPACHETOMCAT-3326460"},{"vulnerability.display_id":"S-53","Title":"Denial of Service (DoS)","Davis Security Score":"MEDIUM (5.9)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2022-42004","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-3038424"},{"vulnerability.display_id":"S-54","Title":"Denial of Service (DoS)","Davis Security Score":"MEDIUM (5.9)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2022-42003","External id":"SNYK-JAVA-COMFASTERXMLJACKSONCORE-3038426"},{"vulnerability.display_id":"S-91","Title":"Deserialization of Untrusted Data","Davis Security Score":"MEDIUM (5.9)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2018-10237","External id":"SNYK-JAVA-COMGOOGLEGUAVA-32236"},{"vulnerability.display_id":"S-128","Title":"Injection","Davis Security Score":"MEDIUM (5.4)","Status":"OPEN","Status date":"Aug 03, 21:28:28","External id":"CVE-2023-23936"},{"vulnerability.display_id":"S-100","Title":"Unprotected Transport of Credentials","Davis Security Score":"MEDIUM (5.3)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2023-28708","External id":"SNYK-JAVA-ORGAPACHETOMCAT-3369685"},{"vulnerability.display_id":"S-125","Title":"Incorrect Authorization","Davis Security Score":"MEDIUM (5.3)","Status":"OPEN","Status date":"Aug 03, 21:27:28","External id":"CVE-2023-23918"},{"vulnerability.display_id":"S-143","Title":"Allocation of Resources Without Limits or Throttling","Davis Security Score":"MEDIUM (5.3)","Status":"OPEN","Status date":"Aug 03, 22:16:28","CVE list":"CVE-2023-20861","External id":"SNYK-JAVA-ORGSPRINGFRAMEWORK-3369749"},{"vulnerability.display_id":"S-26","Title":"Directory Traversal","Davis Security Score":"MEDIUM (5.3)","Status":"OPEN","Status date":"Aug 03, 20:52:28","CVE list":"CVE-2021-29425","External id":"SNYK-JAVA-COMMONSIO-1277109"},{"vulnerability.display_id":"S-97","Title":"Improper Input Validation","Davis Security Score":"MEDIUM (5.3)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-13956","External id":"SNYK-JAVA-ORGAPACHEHTTPCOMPONENTS-1048058"},{"vulnerability.display_id":"S-32","Title":"Insufficient Hostname Verification","Davis Security Score":"MEDIUM (4.8)","Status":"OPEN","Status date":"Aug 03, 20:53:28","External id":"SNYK-JAVA-CHQOSLOGBACK-1726923"},{"vulnerability.display_id":"S-122","Title":"Man-in-the-Middle (MitM)","Davis Security Score":"MEDIUM (4.3)","Status":"OPEN","Status date":"Aug 03, 21:24:28","CVE list":"CVE-2012-6153","External id":"SNYK-JAVA-COMMONSHTTPCLIENT-31660"},{"vulnerability.display_id":"S-142","Title":"Improper Input Validation","Davis Security Score":"MEDIUM (4.3)","Status":"OPEN","Status date":"Aug 03, 22:16:28","External id":"SNYK-JAVA-IOSPRINGFOX-1317096"},{"vulnerability.display_id":"S-22","Title":"Regular Expression Denial of Service (ReDoS)","Davis Security Score":"MEDIUM (4.3)","Status":"OPEN","Status date":"Aug 03, 20:48:28","CVE list":"CVE-2022-25901","External id":"SNYK-JS-COOKIEJAR-3149984"},{"vulnerability.display_id":"S-24","Title":"Open Redirect","Davis Security Score":"MEDIUM (4.1)","Status":"OPEN","Status date":"Aug 03, 20:48:28","CVE list":"CVE-2020-8561","External id":"SNYK-GOLANG-K8SIOKUBERNETES-1585632"},{"vulnerability.display_id":"S-21","Title":"CVE-2023-21968","Davis Security Score":"LOW (3.7)","Status":"OPEN","Status date":"Aug 03, 20:48:28","External id":"CVE-2023-21968"},{"vulnerability.display_id":"S-90","Title":"Information Disclosure","Davis Security Score":"LOW (3.3)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2020-8908","External id":"SNYK-JAVA-COMGOOGLEGUAVA-1015415"},{"vulnerability.display_id":"S-92","Title":"Creation of Temporary File in Directory with Insecure Permissions","Davis Security Score":"LOW (3.3)","Status":"OPEN","Status date":"Aug 03, 20:53:28","CVE list":"CVE-2023-2976","External id":"SNYK-JAVA-COMGOOGLEGUAVA-5710356"},{"vulnerability.display_id":"S-127","Title":"Untrusted Search Path","Davis Security Score":"LOW (2.0)","Status":"OPEN","Status date":"Aug 03, 21:27:28","External id":"CVE-2023-23920"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"VULNERABILITY\"\n| sort timestamp, direction:\"descending\"\n| summarize by:{vulnerability.display_id}, {{takeFirst(vulnerability.resolution.status), alias:vulnerability.resolution.status}, {takeFirst(vulnerability.resolution.change_date), alias:vulnerability.resolution.change_date}, {takeFirst(vulnerability.mute.status), alias:vulnerability.mute.status}, {takeFirst(vulnerability.davis_assessment.score), alias:vulnerability.davis_assessment.score}, {takeFirst(vulnerability.davis_assessment.level), alias:vulnerability.davis_assessment.level}, {takeFirst(vulnerability.title), alias:vulnerability.title}, {takeFirst(vulnerability.external_id), alias:vulnerability.external_id}, {takeFirst(vulnerability.references.cve), alias:vulnerability.references.cve}, {takeFirst(timestamp), alias:timestamp}}\n| filter vulnerability.resolution.status == \"OPEN\" AND vulnerability.mute.status != \"MUTED\"\n| sort vulnerability.davis_assessment.score, direction:\"descending\"\n| fields vulnerability.display_id, {vulnerability.title, alias:Title}, {concat(vulnerability.davis_assessment.level, \" (\", round(vulnerability.davis_assessment.score, decimals:1), \")\"), alias:`Davis Security Score`}, {vulnerability.resolution.status, alias:Status}, {formatTimestamp(toTimestamp(vulnerability.resolution.change_date), format:\"MMM dd, HH:mm:ss\"), alias:`Status date`}, {substring(toString(vulnerability.references.cve), from:1, to:-1), alias:`CVE list`}, {vulnerability.external_id, alias:`External id`}","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.resolution.change_date=takeFirst(vulnerability.resolution.change_date),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status),\nvulnerability.davis_assessment.score=takeFirst(vulnerability.davis_assessment.score),\nvulnerability.davis_assessment.level=takeFirst(vulnerability.davis_assessment.level),\nvulnerability.title=takeFirst(vulnerability.title),\nvulnerability.external_id=takeFirst(vulnerability.external_id),\nvulnerability.references.cve=takeFirst(vulnerability.references.cve),\ntimestamp=takeFirst(timestamp)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\" // filter for open non-muted vulnerabilities\n| sort vulnerability.davis_assessment.score, direction:\"descending\"\n| fields \nvulnerability.display_id,\nTitle=vulnerability.title,\n`Davis Security Score`=concat(vulnerability.davis_assessment.level,\" (\",round(vulnerability.davis_assessment.score,decimals:1),\")\"),\nStatus=vulnerability.resolution.status,\n`Status date`=formatTimestamp(toTimestamp(vulnerability.resolution.change_date), format:\"MMM dd, HH:mm:ss\"),\n`CVE list`=substring(toString(vulnerability.references.cve), from:1, to:-1),\n`External id`=vulnerability.external_id","scannedRecords":3679,"dqlVersion":"V1_0","scannedBytes":1858375,"analysisTimeframe":{"start":"2023-08-07T14:30:34.007Z","end":"2023-08-07T15:00:34.007Z"},"locale":"","executionTimeMilliseconds":1385,"notifications":[],"queryId":"e6249466-a176-4ee1-a4d0-f2da69e07022","sampled":false}},"types":[{"mappings":{"vulnerability.display_id":{"type":"string"},"Title":{"type":"string"},"Davis Security Score":{"type":"string"},"Status":{"type":"string"},"Status date":{"type":"string"},"CVE list":{"type":"string"},"External id":{"type":"string"}},"indexRange":[0,77]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.007Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.resolution.change_date=takeFirst(vulnerability.resolution.change_date),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status),\nvulnerability.davis_assessment.score=takeFirst(vulnerability.davis_assessment.score),\nvulnerability.davis_assessment.level=takeFirst(vulnerability.davis_assessment.level),\nvulnerability.title=takeFirst(vulnerability.title),\nvulnerability.external_id=takeFirst(vulnerability.external_id),\nvulnerability.references.cve=takeFirst(vulnerability.references.cve),\ntimestamp=takeFirst(timestamp)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\" // filter for open non-muted vulnerabilities\n| sort vulnerability.davis_assessment.score, direction:\"descending\"\n| fields \nvulnerability.display_id,\nTitle=vulnerability.title,\n`Davis Security Score`=concat(vulnerability.davis_assessment.level,\" (\",round(vulnerability.davis_assessment.score,decimals:1),\")\"),\nStatus=vulnerability.resolution.status,\n`Status date`=formatTimestamp(toTimestamp(vulnerability.resolution.change_date), format:\"MMM dd, HH:mm:ss\"),\n`CVE list`=substring(toString(vulnerability.references.cve), from:1, to:-1),\n`External id`=vulnerability.external_id","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-04T10:57:03.863Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-04T11:27:03.863Z"}}}}},"visualization":"table","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"height":450,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"384d014b-c59b-40ab-9d1f-c02311ac3737","type":"dql","title":"Fetch top 5 affected entities by vulnerability count","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{\naffected_entity.type=takeFirst(affected_entity.type),\naffected_entity.name=takeFirst(affected_entity.name),\nvulnerability.davis_assessment.exposure_status=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)\n}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n// summarize per affected entity\n| summarize {\n`Affected entity name`=takeFirst(affected_entity.name),\nType=takeFirst(affected_entity.type),\n`# Vulnerabilities`=countDistinct(vulnerability.display_id),\n`Exposure status`=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)},\nby: {affected_entity.id}\n| fieldsRemove affected_entity.id\n| sort {`# Vulnerabilities`,direction:\"descending\"}, `Exposure status`\n| fields \ndt.source_entity=if(isNotNull(dt.entity.process_group),dt.entity.process_group, else:if(isNotNull(dt.entity.host),dt.entity.host,else:dt.entity.kubernetes_node)),\n`Affected entity name`,\nType,\n`# Vulnerabilities`,\n`Exposure status`\n| limit 5 // limit to the top 5 affected entities","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-07-10T15:44:20.634Z"},"to":{"type":"expression","normalized":"now","date":"2023-07-10T16:14:20.634Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"sparklineSettings":{"showSparkline":false,"color":{"Default":"var(--dt-colors-charts-categorical-color-07-default, #004c52)","Hover":"var(--dt-colors-charts-categorical-color-07-hover, #003e42)","Active":"var(--dt-colors-charts-categorical-color-07-active, #002b2e)","DefaultTransparent":"var(--dt-colors-charts-categorical-color-07-default-transparent, #000c0dcc)","HoverTransparent":"var(--dt-colors-charts-categorical-color-07-hover-transparent, #000c)","ActiveTransparent":"var(--dt-colors-charts-categorical-color-07-active-transparent, #000c)"},"variant":"line","record":"none","showTicks":false}},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[["Affected entity name"]],"firstVisibleRowIndex":0,"columnWidths":{}}},"result":{"code":200,"value":{"records":[{"dt.source_entity":"PROCESS_GROUP-3CFF120273384B6B","Affected entity name":"tomcat easytravel-pluginservice-*","Type":"PROCESS_GROUP","# Vulnerabilities":"55","Exposure status":"PUBLIC_NETWORK"},{"dt.source_entity":"PROCESS_GROUP-A6BBB46BDAADE0F2","Affected entity name":"uemload.jar easytravel-headless-loadgen-*","Type":"PROCESS_GROUP","# Vulnerabilities":"54","Exposure status":"PUBLIC_NETWORK"},{"dt.source_entity":"PROCESS_GROUP-FD8BFBA6A1478950","Affected entity name":"tomcat easytravel-frontend-*","Type":"PROCESS_GROUP","# Vulnerabilities":"11","Exposure status":"PUBLIC_NETWORK"},{"dt.source_entity":"PROCESS_GROUP-D8E412E8B0D3DC5C","Affected entity name":"SpringBoot com.dynatrace.easytrade.engine.EngineApplication engine-*","Type":"PROCESS_GROUP","# Vulnerabilities":"8","Exposure status":"PUBLIC_NETWORK"},{"dt.source_entity":"PROCESS_GROUP-FD6E1AB213F2FE92","Affected entity name":"SpringBoot com.dynatrace.easytrade.accountservice.AccountServiceApplic accountservice-*","Type":"PROCESS_GROUP","# Vulnerabilities":"8","Exposure status":"PUBLIC_NETWORK"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"ENTITY\"\n| sort timestamp, direction:\"descending\"\n| summarize by:{affected_entity.id, vulnerability.display_id}, {{takeFirst(affected_entity.type), alias:affected_entity.type}, {takeFirst(affected_entity.name), alias:affected_entity.name}, {takeFirst(vulnerability.davis_assessment.exposure_status), alias:vulnerability.davis_assessment.exposure_status}, {takeFirst(dt.entity.process_group), alias:dt.entity.process_group}, {takeFirst(dt.entity.host), alias:dt.entity.host}, {takeFirst(dt.entity.kubernetes_node), alias:dt.entity.kubernetes_node}}\n| summarize by:{affected_entity.id}, {{takeFirst(affected_entity.name), alias:`Affected entity name`}, {takeFirst(affected_entity.type), alias:Type}, {countDistinct(vulnerability.display_id), alias:`# Vulnerabilities`}, {takeFirst(vulnerability.davis_assessment.exposure_status), alias:`Exposure status`}, {takeFirst(dt.entity.process_group), alias:dt.entity.process_group}, {takeFirst(dt.entity.host), alias:dt.entity.host}, {takeFirst(dt.entity.kubernetes_node), alias:dt.entity.kubernetes_node}}\n| fieldsRemove affected_entity.id\n| sort {`# Vulnerabilities`, direction:\"descending\"}, `Exposure status`\n| fields {if(isNotNull(dt.entity.process_group), dt.entity.process_group, else:if(isNotNull(dt.entity.host), dt.entity.host, else:dt.entity.kubernetes_node)), alias:dt.source_entity}, `Affected entity name`, Type, `# Vulnerabilities`, `Exposure status`\n| limit 5","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{\naffected_entity.type=takeFirst(affected_entity.type),\naffected_entity.name=takeFirst(affected_entity.name),\nvulnerability.davis_assessment.exposure_status=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)\n}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n// summarize per affected entity\n| summarize {\n`Affected entity name`=takeFirst(affected_entity.name),\nType=takeFirst(affected_entity.type),\n`# Vulnerabilities`=countDistinct(vulnerability.display_id),\n`Exposure status`=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)},\nby: {affected_entity.id}\n| fieldsRemove affected_entity.id\n| sort {`# Vulnerabilities`,direction:\"descending\"}, `Exposure status`\n| fields \ndt.source_entity=if(isNotNull(dt.entity.process_group),dt.entity.process_group, else:if(isNotNull(dt.entity.host),dt.entity.host,else:dt.entity.kubernetes_node)),\n`Affected entity name`,\nType,\n`# Vulnerabilities`,\n`Exposure status`\n| limit 5 // limit to the top 5 affected entities","scannedRecords":3679,"dqlVersion":"V1_0","scannedBytes":3127547,"analysisTimeframe":{"start":"2023-08-07T14:30:34.010Z","end":"2023-08-07T15:00:34.010Z"},"locale":"","executionTimeMilliseconds":177,"notifications":[],"queryId":"625de7fd-176c-46f2-98ef-026b27fa4963","sampled":false}},"types":[{"mappings":{"dt.source_entity":{"type":"string"},"Affected entity name":{"type":"string"},"Type":{"type":"string"},"# Vulnerabilities":{"type":"long"},"Exposure status":{"type":"string"}},"indexRange":[0,4]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.010Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{\naffected_entity.type=takeFirst(affected_entity.type),\naffected_entity.name=takeFirst(affected_entity.name),\nvulnerability.davis_assessment.exposure_status=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)\n}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n// summarize per affected entity\n| summarize {\n`Affected entity name`=takeFirst(affected_entity.name),\nType=takeFirst(affected_entity.type),\n`# Vulnerabilities`=countDistinct(vulnerability.display_id),\n`Exposure status`=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)},\nby: {affected_entity.id}\n| fieldsRemove affected_entity.id\n| sort {`# Vulnerabilities`,direction:\"descending\"}, `Exposure status`\n| fields \ndt.source_entity=if(isNotNull(dt.entity.process_group),dt.entity.process_group, else:if(isNotNull(dt.entity.host),dt.entity.host,else:dt.entity.kubernetes_node)),\n`Affected entity name`,\nType,\n`# Vulnerabilities`,\n`Exposure status`\n| limit 5 // limit to the top 5 affected entities","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-07-10T15:44:20.634Z"},"to":{"type":"expression","normalized":"now","date":"2023-07-10T16:14:20.634Z"}}}}},"visualization":"table","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}},"showInput":false,"height":279,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}}},{"id":"a68c02f6-a055-4934-bba0-213c658aaf75","type":"markdown","markdown":"# More options"},{"id":"4fcb8059-9f14-4f56-8d20-ff33131ba010","type":"dql","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{affected_entity.type=takeFirst(affected_entity.type)}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n| summarize Count=countDistinct(affected_entity.id), by: {affected_entity.type, alias:`Entity type`}","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-07-10T15:44:20.634Z"},"to":{"type":"expression","normalized":"now","date":"2023-07-10T16:14:20.634Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative"},"categoricalBarChartSettings":{"categoryAxisTickLayout":"horizontal","layout":"vertical","categoryAxis":["Entity type"],"categoryAxisLabel":["Entity type"],"valueAxis":["Count"],"valueAxisLabel":["Count"]}},"table":{"enableLineWrap":false,"lineWrapIds":[]}},"result":{"code":200,"value":{"records":[{"Entity type":"HOST","Count":"3"},{"Entity type":"PROCESS_GROUP","Count":"13"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"ENTITY\"\n| sort timestamp, direction:\"descending\"\n| summarize by:{affected_entity.id, vulnerability.display_id}, takeFirst(affected_entity.type), alias:affected_entity.type\n| summarize by:{affected_entity.type, alias:`Entity type`}, countDistinct(affected_entity.id), alias:Count","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{affected_entity.type=takeFirst(affected_entity.type)}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n| summarize Count=countDistinct(affected_entity.id), by: {affected_entity.type, alias:`Entity type`}","scannedRecords":3679,"dqlVersion":"V1_0","scannedBytes":3127547,"analysisTimeframe":{"start":"2023-08-07T14:30:34.013Z","end":"2023-08-07T15:00:34.013Z"},"locale":"","executionTimeMilliseconds":165,"notifications":[],"queryId":"788d3eaf-1454-4572-8c8a-be9b065fc603","sampled":false}},"types":[{"mappings":{"Entity type":{"type":"string"},"Count":{"type":"long"}},"indexRange":[0,1]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.013Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{affected_entity.type=takeFirst(affected_entity.type)}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n| summarize Count=countDistinct(affected_entity.id), by: {affected_entity.type, alias:`Entity type`}","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-07-10T15:44:20.634Z"},"to":{"type":"expression","normalized":"now","date":"2023-07-10T16:14:20.634Z"}}}}},"visualization":"categoricalBarChart","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"height":450,"title":"Chart affected entities count by type","davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"07177510-d40e-412a-a80c-2dbde1d5c704","type":"dql","title":"Chart top 5 vulnerability types","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.type=takeFirst(vulnerability.type),\nvulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)\n},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\"\n| fields vulnerability.type\n| summarize \nvulnerabilities=count(), by:{vulnerability.type}\n| sort vulnerabilities,direction:\"descending\"\n|limit 5","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-12T08:47:39.358Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:17:39.358Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative"},"colorPalette":"log-status"},"singleValue":{"showLabel":true,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":89}},"result":{"code":200,"value":{"records":[{"vulnerability.type":"Deserialization of Untrusted Data","vulnerabilities":"43"},{"vulnerability.type":"Not available","vulnerabilities":"7"},{"vulnerability.type":"Uncontrolled Resource Consumption","vulnerabilities":"6"},{"vulnerability.type":"Improper Input Validation","vulnerabilities":"4"},{"vulnerability.type":"Allocation of Resources Without Limits or Throttling","vulnerabilities":"2"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"VULNERABILITY\"\n| sort timestamp, direction:\"descending\"\n| summarize by:{vulnerability.display_id}, {{takeFirst(vulnerability.type), alias:vulnerability.type}, {takeFirst(vulnerability.resolution.status), alias:vulnerability.resolution.status}, {takeFirst(vulnerability.mute.status), alias:vulnerability.mute.status}}\n| filter vulnerability.resolution.status == \"OPEN\" AND vulnerability.mute.status != \"MUTED\"\n| fields vulnerability.type\n| summarize by:{vulnerability.type}, count(), alias:vulnerabilities\n| sort vulnerabilities, direction:\"descending\"\n| limit 5","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.type=takeFirst(vulnerability.type),\nvulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)\n},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\"\n| fields vulnerability.type\n| summarize \nvulnerabilities=count(), by:{vulnerability.type}\n| sort vulnerabilities,direction:\"descending\"\n|limit 5","scannedRecords":3679,"dqlVersion":"V1_0","scannedBytes":1858375,"analysisTimeframe":{"start":"2023-08-07T14:30:34.016Z","end":"2023-08-07T15:00:34.016Z"},"locale":"","executionTimeMilliseconds":179,"notifications":[],"queryId":"2d1af1fa-ce6e-493f-8c30-215e341f2dc3","sampled":false}},"types":[{"mappings":{"vulnerability.type":{"type":"string"},"vulnerabilities":{"type":"long"}},"indexRange":[0,4]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.016Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.type=takeFirst(vulnerability.type),\nvulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)\n},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\"\n| fields vulnerability.type\n| summarize \nvulnerabilities=count(), by:{vulnerability.type}\n| sort vulnerabilities,direction:\"descending\"\n|limit 5","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-12T08:47:39.358Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:17:39.358Z"}}}}},"visualization":"pieChart","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"height":325,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"f6377dcc-d977-49c2-b2fc-7557b5c9d1ee","type":"dql","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{\nvulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.stack=takeFirst(vulnerability.stack),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)\n},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\"\n| summarize vulnerabilities=countDistinct(vulnerability.display_id), by: {vulnerability.stack}","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-05-11T09:22:48.455Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:22:48.455Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative"},"categoricalBarChartSettings":{"categoryAxisTickLayout":"horizontal","layout":"horizontal","categoryAxis":"vulnerability.stack","categoryAxisLabel":"vulnerability.stack","valueAxis":"vulnerabilities","valueAxisLabel":"vulnerabilities"}},"table":{"enableLineWrap":false,"lineWrapIds":[]}},"result":{"code":200,"value":{"records":[{"vulnerability.stack":"CODE_LIBRARY","vulnerabilities":"66"},{"vulnerability.stack":"CONTAINER_ORCHESTRATION","vulnerabilities":"1"},{"vulnerability.stack":"SOFTWARE","vulnerabilities":"11"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"VULNERABILITY\"\n| sort timestamp, direction:\"descending\"\n| summarize by:{vulnerability.display_id}, {{takeFirst(vulnerability.resolution.status), alias:vulnerability.resolution.status}, {takeFirst(vulnerability.stack), alias:vulnerability.stack}, {takeFirst(vulnerability.mute.status), alias:vulnerability.mute.status}}\n| filter vulnerability.resolution.status == \"OPEN\" AND vulnerability.mute.status != \"MUTED\"\n| summarize by:{vulnerability.stack}, countDistinct(vulnerability.display_id), alias:vulnerabilities","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{\nvulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.stack=takeFirst(vulnerability.stack),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)\n},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\"\n| summarize vulnerabilities=countDistinct(vulnerability.display_id), by: {vulnerability.stack}","scannedRecords":14527,"dqlVersion":"V1_0","scannedBytes":12229788,"analysisTimeframe":{"start":"2023-08-06T15:00:34.021Z","end":"2023-08-07T15:00:34.021Z"},"locale":"","executionTimeMilliseconds":1431,"notifications":[],"queryId":"a4afa18a-84e3-4375-a6ed-f8e1e1a225d9","sampled":false}},"types":[{"mappings":{"vulnerability.stack":{"type":"string"},"vulnerabilities":{"type":"long"}},"indexRange":[0,2]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.019Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{\nvulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.stack=takeFirst(vulnerability.stack),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)\n},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\"\n| summarize vulnerabilities=countDistinct(vulnerability.display_id), by: {vulnerability.stack}","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-05-11T09:22:48.455Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:22:48.455Z"}}}}},"visualization":"categoricalBarChart","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"height":450,"title":"Chart vulnerability count by stack level","davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"41398730-ae99-4d6e-8748-b1746cb56a1d","type":"dql","title":"Chart open non-muted vulnerabilities (by risk level)","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status),\nvulnerability.risk.score=takeFirst(vulnerability.risk.score),\nvulnerability.risk.level=takeFirst(vulnerability.risk.level)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\"\n| sort vulnerability.risk.score, direction:\"descending\"\n| summarize \nRisk=count(),\nby: {`Risk level`=vulnerability.risk.level}","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-04T10:57:03.863Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-04T11:27:03.863Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"colorPalette":"vulnerability-risk-level","categoricalBarChartSettings":{"categoryAxis":"Risk level","categoryAxisLabel":"Risk level","valueAxis":["Risk"],"valueAxisLabel":["Risk"]}},"table":{"enableLineWrap":false,"lineWrapIds":[]}},"result":{"code":200,"value":{"records":[{"Risk level":"HIGH","Risk":"52"},{"Risk level":"LOW","Risk":"4"},{"Risk level":"MEDIUM","Risk":"22"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"VULNERABILITY\"\n| sort timestamp, direction:\"descending\"\n| summarize by:{vulnerability.display_id}, {{takeFirst(vulnerability.resolution.status), alias:vulnerability.resolution.status}, {takeFirst(vulnerability.mute.status), alias:vulnerability.mute.status}, {takeFirst(vulnerability.risk.score), alias:vulnerability.risk.score}, {takeFirst(vulnerability.risk.level), alias:vulnerability.risk.level}}\n| filter vulnerability.resolution.status == \"OPEN\" AND vulnerability.mute.status != \"MUTED\"\n| sort vulnerability.risk.score, direction:\"descending\"\n| summarize by:{vulnerability.risk.level, alias:`Risk level`}, count(), alias:Risk","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status),\nvulnerability.risk.score=takeFirst(vulnerability.risk.score),\nvulnerability.risk.level=takeFirst(vulnerability.risk.level)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\"\n| sort vulnerability.risk.score, direction:\"descending\"\n| summarize \nRisk=count(),\nby: {`Risk level`=vulnerability.risk.level}","scannedRecords":3679,"dqlVersion":"V1_0","scannedBytes":1858375,"analysisTimeframe":{"start":"2023-08-07T14:30:34.024Z","end":"2023-08-07T15:00:34.024Z"},"locale":"","executionTimeMilliseconds":190,"notifications":[],"queryId":"154985b9-ac48-4cfb-94f5-3aa424d57ca8","sampled":false}},"types":[{"mappings":{"Risk level":{"type":"string"},"Risk":{"type":"long"}},"indexRange":[0,2]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.023Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status),\nvulnerability.risk.score=takeFirst(vulnerability.risk.score),\nvulnerability.risk.level=takeFirst(vulnerability.risk.level)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" AND vulnerability.mute.status!=\"MUTED\"\n| sort vulnerability.risk.score, direction:\"descending\"\n| summarize \nRisk=count(),\nby: {`Risk level`=vulnerability.risk.level}","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-04T10:57:03.863Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-04T11:27:03.863Z"}}}}},"visualization":"categoricalBarChart","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"height":450,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"04a5e415-c85c-4e52-a0d4-613675e15b50","type":"dql","title":"Fetch total number of open non-muted vulnerabilities","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" and vulnerability.mute.status==\"NOT_MUTED\"\n| summarize \n`Open Vulnerabilities`=countDistinct(vulnerability.display_id)","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-12T08:46:06.639Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:16:06.639Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative"},"colorPalette":"log-status"},"singleValue":{"showLabel":true,"label":"","autoscale":false},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0}},"result":{"code":200,"value":{"records":[{"Open Vulnerabilities":"78"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"VULNERABILITY\"\n| sort timestamp, direction:\"descending\"\n| summarize by:{vulnerability.display_id}, {{takeFirst(vulnerability.resolution.status), alias:vulnerability.resolution.status}, {takeFirst(vulnerability.mute.status), alias:vulnerability.mute.status}}\n| filter vulnerability.resolution.status == \"OPEN\" AND vulnerability.mute.status == \"NOT_MUTED\"\n| summarize countDistinct(vulnerability.display_id), alias:`Open Vulnerabilities`","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" and vulnerability.mute.status==\"NOT_MUTED\"\n| summarize \n`Open Vulnerabilities`=countDistinct(vulnerability.display_id)","scannedRecords":3679,"dqlVersion":"V1_0","scannedBytes":1858375,"analysisTimeframe":{"start":"2023-08-07T14:30:34.027Z","end":"2023-08-07T15:00:34.027Z"},"locale":"","executionTimeMilliseconds":170,"notifications":[],"queryId":"bf99559b-3179-4024-ba0d-62e91447ea1c","sampled":false}},"types":[{"mappings":{"Open Vulnerabilities":{"type":"long"}},"indexRange":[0,0]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.026Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"VULNERABILITY\"\n// filter only the latest snapshot data\n| sort timestamp, direction:\"descending\"\n| summarize \n{vulnerability.resolution.status=takeFirst(vulnerability.resolution.status),\nvulnerability.mute.status=takeFirst(vulnerability.mute.status)},\nby: {vulnerability.display_id}\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" and vulnerability.mute.status==\"NOT_MUTED\"\n| summarize \n`Open Vulnerabilities`=countDistinct(vulnerability.display_id)","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-12T08:46:06.639Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:16:06.639Z"}}}}},"visualization":"singleValue","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"height":325,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"6e0efab6-f7d2-405a-8370-8e0301fa9490","type":"dql","title":"Fetch total number of affected entities","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// filter only the latest snapshot data\n| fieldsAdd matcher=\"match\"\n| lookup [\nfetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n| fields \nmaxTimestamp=timestamp,\nmatcher=\"match\"\n| limit 1\n], sourceField:matcher, lookupField:matcher\n| filter timestamp==lookup.maxTimestamp\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" and vulnerability.mute.status==\"NOT_MUTED\"\n| summarize \n`Affected Entities`=countDistinct(affected_entity.id)","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-12T08:51:08.974Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:21:08.974Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative"},"colorPalette":"log-status"},"singleValue":{"showLabel":true,"label":"","autoscale":false},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0}},"result":{"code":200,"value":{"records":[{"Affected Entities":"16"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"ENTITY\"\n| fieldsAdd \"match\", alias:matcher\n| lookup \n\t[\n\t\tfetch events\n\t\t| filter event.provider == \"Dynatrace\"\n\t\t| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n\t\t| filter event.level == \"ENTITY\"\n\t\t| fields {timestamp, alias:maxTimestamp}, {\"match\", alias:matcher}\n\t\t| limit 1\n\t], sourceField:matcher, lookupField:matcher\n| filter timestamp == lookup.maxTimestamp\n| filter vulnerability.resolution.status == \"OPEN\" AND vulnerability.mute.status == \"NOT_MUTED\"\n| summarize countDistinct(affected_entity.id), alias:`Affected Entities`","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// filter only the latest snapshot data\n| fieldsAdd matcher=\"match\"\n| lookup [\nfetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n| fields \nmaxTimestamp=timestamp,\nmatcher=\"match\"\n| limit 1\n], sourceField:matcher, lookupField:matcher\n| filter timestamp==lookup.maxTimestamp\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" and vulnerability.mute.status==\"NOT_MUTED\"\n| summarize \n`Affected Entities`=countDistinct(affected_entity.id)","scannedRecords":4589,"dqlVersion":"V1_0","scannedBytes":3251126,"analysisTimeframe":{"start":"2023-08-07T14:30:34.030Z","end":"2023-08-07T15:00:34.030Z"},"locale":"","executionTimeMilliseconds":188,"notifications":[],"queryId":"373b8a6e-dbc4-46d0-b833-aa405455e18b","sampled":false}},"types":[{"mappings":{"Affected Entities":{"type":"long"}},"indexRange":[0,0]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.029Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// filter only the latest snapshot data\n| fieldsAdd matcher=\"match\"\n| lookup [\nfetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n| fields \nmaxTimestamp=timestamp,\nmatcher=\"match\"\n| limit 1\n], sourceField:matcher, lookupField:matcher\n| filter timestamp==lookup.maxTimestamp\n//end of filtering for the latest snapshot\n| filter vulnerability.resolution.status==\"OPEN\" and vulnerability.mute.status==\"NOT_MUTED\"\n| summarize \n`Affected Entities`=countDistinct(affected_entity.id)","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-12T08:51:08.974Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:21:08.974Z"}}}}},"visualization":"singleValue","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"height":325,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"cdd83634-8add-4f0a-bb21-798c00657a23","type":"dql","title":"Chart a trend of affected entities count","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n| summarize\n{`Affected entities`=arraySize(collectDistinct(affected_entity.id))},\nby: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\n{`Affected entities`=takeFirst(`Affected entities`)},\nby: {bin(timestamp, 1h),alias:timestamp}\n| sort timestamp, direction:\"descending\"","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-05-11T09:22:48.455Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:22:48.455Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0}},"result":{"code":200,"value":{"records":[{"timestamp":"2023-08-07T16:00:00.000000000+02:00","Affected entities":"16"},{"timestamp":"2023-08-07T15:00:00.000000000+02:00","Affected entities":"16"},{"timestamp":"2023-08-07T14:00:00.000000000+02:00","Affected entities":"16"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"ENTITY\"\n| summarize by:{timestamp}, arraySize(collectDistinct(affected_entity.id)), alias:`Affected entities`\n| sort timestamp, direction:\"descending\"\n| summarize by:{bin(timestamp, 1h), alias:timestamp}, takeFirst(`Affected entities`), alias:`Affected entities`\n| sort timestamp, direction:\"descending\"","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n| summarize\n{`Affected entities`=arraySize(collectDistinct(affected_entity.id))},\nby: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\n{`Affected entities`=takeFirst(`Affected entities`)},\nby: {bin(timestamp, 1h),alias:timestamp}\n| sort timestamp, direction:\"descending\"","scannedRecords":14527,"dqlVersion":"V1_0","scannedBytes":19105256,"analysisTimeframe":{"start":"2023-08-06T15:00:34.033Z","end":"2023-08-07T15:00:34.033Z"},"locale":"","executionTimeMilliseconds":180,"notifications":[],"queryId":"37c50021-6979-436d-8462-8d4e99fe278e","sampled":false}},"types":[{"mappings":{"timestamp":{"type":"timestamp"},"Affected entities":{"type":"long"}},"indexRange":[0,2]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.033Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n| summarize\n{`Affected entities`=arraySize(collectDistinct(affected_entity.id))},\nby: {timestamp}\n| sort timestamp, direction:\"descending\"\n| summarize\n{`Affected entities`=takeFirst(`Affected entities`)},\nby: {bin(timestamp, 1h),alias:timestamp}\n| sort timestamp, direction:\"descending\"","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-05-11T09:22:48.455Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-12T09:22:48.455Z"}}}}},"visualization":"areaChart","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"height":450,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"ec0360f9-f00e-41f1-8463-b5401a5385d8","type":"dql","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{\naffected_entity.type=takeFirst(affected_entity.type),\naffected_entity.name=takeFirst(affected_entity.name),\naffected_entity.affected_processes.count=takeFirst(affected_entity.affected_processes.count),\nvulnerability.davis_assessment.exposure_status=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)\n}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n// summarize per affected entity\n| summarize {\n`Affected entity name`=takeFirst(affected_entity.name),\nType=takeFirst(affected_entity.type),\n`# Vulnerabilities`=countDistinct(vulnerability.display_id),\n`# Affected processes`=takeFirst(affected_entity.affected_processes.count),\n`Internet exposure`=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)},\nby: {affected_entity.id}\n| fieldsRemove affected_entity.id\n| sort {`# Vulnerabilities`,direction:\"descending\"}, {`# Affected processes`,direction:\"descending\"}, `Internet exposure`\n| limit 5 // limit to the top 5 affected entities\n//add ownership information\n| lookup [\nfetch dt.entity.process_group\n| fieldsAdd tags\n], sourceField:dt.entity.process_group, lookupField:id\n| fieldsRename Tags=lookup.tags\n| parse toString(Tags), \"LD ('owner:'|'owner\\\\\\\\:') (SPACE)? LD:Team ('\\\"')\" // extract the ownership information\n| fieldsAdd Team\n| fieldsRemove lookup.id, lookup.entity.name, Tags\n| fields \ndt.source_entity=if(isNotNull(dt.entity.process_group),dt.entity.process_group, else:if(isNotNull(dt.entity.host),dt.entity.host,else:dt.entity.kubernetes_node)),\n`Affected entity name`,\nType,\n`Owner team`=if(isNotNull(Team),Team, else:\"NOT ASSIGNED\"),\n`# Vulnerabilities`,\n`# Affected processes`,\n`Internet exposure`","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-04T13:45:20.219Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-04T14:15:20.219Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["Affected entity name"]],"firstVisibleRowIndex":0}},"result":{"code":200,"value":{"records":[{"dt.source_entity":"PROCESS_GROUP-3CFF120273384B6B","Affected entity name":"tomcat easytravel-pluginservice-*","Type":"PROCESS_GROUP","Owner team":"NOT ASSIGNED","# Vulnerabilities":"55","# Affected processes":1,"Internet exposure":"PUBLIC_NETWORK"},{"dt.source_entity":"PROCESS_GROUP-A6BBB46BDAADE0F2","Affected entity name":"uemload.jar easytravel-headless-loadgen-*","Type":"PROCESS_GROUP","Owner team":"NOT ASSIGNED","# Vulnerabilities":"54","# Affected processes":1,"Internet exposure":"PUBLIC_NETWORK"},{"dt.source_entity":"PROCESS_GROUP-FD8BFBA6A1478950","Affected entity name":"tomcat easytravel-frontend-*","Type":"PROCESS_GROUP","Owner team":"NOT ASSIGNED","# Vulnerabilities":"11","# Affected processes":2,"Internet exposure":"PUBLIC_NETWORK"},{"dt.source_entity":"PROCESS_GROUP-D8E412E8B0D3DC5C","Affected entity name":"SpringBoot com.dynatrace.easytrade.engine.EngineApplication engine-*","Type":"PROCESS_GROUP","Owner team":"NOT ASSIGNED","# Vulnerabilities":"8","# Affected processes":1,"Internet exposure":"PUBLIC_NETWORK"},{"dt.source_entity":"PROCESS_GROUP-FD6E1AB213F2FE92","Affected entity name":"SpringBoot com.dynatrace.easytrade.accountservice.AccountServiceApplic accountservice-*","Type":"PROCESS_GROUP","Owner team":"NOT ASSIGNED","# Vulnerabilities":"8","# Affected processes":1,"Internet exposure":"PUBLIC_NETWORK"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"ENTITY\"\n| sort timestamp, direction:\"descending\"\n| summarize by:{affected_entity.id, vulnerability.display_id}, {{takeFirst(affected_entity.type), alias:affected_entity.type}, {takeFirst(affected_entity.name), alias:affected_entity.name}, {takeFirst(affected_entity.affected_processes.count), alias:affected_entity.affected_processes.count}, {takeFirst(vulnerability.davis_assessment.exposure_status), alias:vulnerability.davis_assessment.exposure_status}, {takeFirst(dt.entity.process_group), alias:dt.entity.process_group}, {takeFirst(dt.entity.host), alias:dt.entity.host}, {takeFirst(dt.entity.kubernetes_node), alias:dt.entity.kubernetes_node}}\n| summarize by:{affected_entity.id}, {{takeFirst(affected_entity.name), alias:`Affected entity name`}, {takeFirst(affected_entity.type), alias:Type}, {countDistinct(vulnerability.display_id), alias:`# Vulnerabilities`}, {takeFirst(affected_entity.affected_processes.count), alias:`# Affected processes`}, {takeFirst(vulnerability.davis_assessment.exposure_status), alias:`Internet exposure`}, {takeFirst(dt.entity.process_group), alias:dt.entity.process_group}, {takeFirst(dt.entity.host), alias:dt.entity.host}, {takeFirst(dt.entity.kubernetes_node), alias:dt.entity.kubernetes_node}}\n| fieldsRemove affected_entity.id\n| sort {`# Vulnerabilities`, direction:\"descending\"}, {`# Affected processes`, direction:\"descending\"}, `Internet exposure`\n| limit 5\n| lookup \n\t[\n\t\tfetch dt.entity.process_group\n\t\t| fieldsAdd tags\n\t], sourceField:dt.entity.process_group, lookupField:id\n| fieldsRename lookup.tags, alias:Tags\n| parse toString(Tags), \"LD ('owner:'|'owner\\\\\\\\:') (SPACE)? LD:Team ('\\\"')\"\n| fieldsAdd Team\n| fieldsRemove lookup.id, lookup.entity.name, Tags\n| fields {if(isNotNull(dt.entity.process_group), dt.entity.process_group, else:if(isNotNull(dt.entity.host), dt.entity.host, else:dt.entity.kubernetes_node)), alias:dt.source_entity}, `Affected entity name`, Type, {if(isNotNull(Team), Team, else:\"NOT ASSIGNED\"), alias:`Owner team`}, `# Vulnerabilities`, `# Affected processes`, `Internet exposure`","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{\naffected_entity.type=takeFirst(affected_entity.type),\naffected_entity.name=takeFirst(affected_entity.name),\naffected_entity.affected_processes.count=takeFirst(affected_entity.affected_processes.count),\nvulnerability.davis_assessment.exposure_status=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)\n}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n// summarize per affected entity\n| summarize {\n`Affected entity name`=takeFirst(affected_entity.name),\nType=takeFirst(affected_entity.type),\n`# Vulnerabilities`=countDistinct(vulnerability.display_id),\n`# Affected processes`=takeFirst(affected_entity.affected_processes.count),\n`Internet exposure`=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)},\nby: {affected_entity.id}\n| fieldsRemove affected_entity.id\n| sort {`# Vulnerabilities`,direction:\"descending\"}, {`# Affected processes`,direction:\"descending\"}, `Internet exposure`\n| limit 5 // limit to the top 5 affected entities\n//add ownership information\n| lookup [\nfetch dt.entity.process_group\n| fieldsAdd tags\n], sourceField:dt.entity.process_group, lookupField:id\n| fieldsRename Tags=lookup.tags\n| parse toString(Tags), \"LD ('owner:'|'owner\\\\\\\\:') (SPACE)? LD:Team ('\\\"')\" // extract the ownership information\n| fieldsAdd Team\n| fieldsRemove lookup.id, lookup.entity.name, Tags\n| fields \ndt.source_entity=if(isNotNull(dt.entity.process_group),dt.entity.process_group, else:if(isNotNull(dt.entity.host),dt.entity.host,else:dt.entity.kubernetes_node)),\n`Affected entity name`,\nType,\n`Owner team`=if(isNotNull(Team),Team, else:\"NOT ASSIGNED\"),\n`# Vulnerabilities`,\n`# Affected processes`,\n`Internet exposure`","scannedRecords":3772,"dqlVersion":"V1_0","scannedBytes":3139773,"analysisTimeframe":{"start":"2023-08-07T14:30:34.037Z","end":"2023-08-07T15:00:34.037Z"},"locale":"","executionTimeMilliseconds":368,"notifications":[],"queryId":"25453c60-4cfa-47c7-9005-012d7c72677d","sampled":false}},"types":[{"mappings":{"dt.source_entity":{"type":"string"},"Affected entity name":{"type":"string"},"Type":{"type":"string"},"Owner team":{"type":"string"},"# Vulnerabilities":{"type":"long"},"# Affected processes":{"type":"double"},"Internet exposure":{"type":"string"}},"indexRange":[0,4]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.036Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{\naffected_entity.type=takeFirst(affected_entity.type),\naffected_entity.name=takeFirst(affected_entity.name),\naffected_entity.affected_processes.count=takeFirst(affected_entity.affected_processes.count),\nvulnerability.davis_assessment.exposure_status=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)\n}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n// summarize per affected entity\n| summarize {\n`Affected entity name`=takeFirst(affected_entity.name),\nType=takeFirst(affected_entity.type),\n`# Vulnerabilities`=countDistinct(vulnerability.display_id),\n`# Affected processes`=takeFirst(affected_entity.affected_processes.count),\n`Internet exposure`=takeFirst(vulnerability.davis_assessment.exposure_status),\ndt.entity.process_group=takeFirst(dt.entity.process_group),\ndt.entity.host=takeFirst(dt.entity.host),\ndt.entity.kubernetes_node=takeFirst(dt.entity.kubernetes_node)},\nby: {affected_entity.id}\n| fieldsRemove affected_entity.id\n| sort {`# Vulnerabilities`,direction:\"descending\"}, {`# Affected processes`,direction:\"descending\"}, `Internet exposure`\n| limit 5 // limit to the top 5 affected entities\n//add ownership information\n| lookup [\nfetch dt.entity.process_group\n| fieldsAdd tags\n], sourceField:dt.entity.process_group, lookupField:id\n| fieldsRename Tags=lookup.tags\n| parse toString(Tags), \"LD ('owner:'|'owner\\\\\\\\:') (SPACE)? LD:Team ('\\\"')\" // extract the ownership information\n| fieldsAdd Team\n| fieldsRemove lookup.id, lookup.entity.name, Tags\n| fields \ndt.source_entity=if(isNotNull(dt.entity.process_group),dt.entity.process_group, else:if(isNotNull(dt.entity.host),dt.entity.host,else:dt.entity.kubernetes_node)),\n`Affected entity name`,\nType,\n`Owner team`=if(isNotNull(Team),Team, else:\"NOT ASSIGNED\"),\n`# Vulnerabilities`,\n`# Affected processes`,\n`Internet exposure`","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-04T13:45:20.219Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-04T14:15:20.219Z"}}}}},"visualization":"table","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"title":"Fetch top 5 affected entities with owners (sorted by vulnerability count)","height":314,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}},{"id":"d16041d6-6873-47e9-9746-5fc5503be246","type":"dql","title":"Fetch top 5 owner teams by vulnerability count","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n| filter isNotNull(dt.entity.process_group)\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{\ndt.entity.process_group=takeFirst(dt.entity.process_group)\n}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n//add ownership information\n| lookup [\nfetch dt.entity.process_group\n| fieldsAdd tags\n], sourceField:dt.entity.process_group, lookupField:id\n| fieldsRename Tags=lookup.tags\n| parse toString(Tags), \"LD ('owner:'|'owner\\\\\\\\:') (SPACE)? LD:Team ('\\\"')\"\n| fieldsAdd Team=if(isNotNull(Team),Team,else:\"-\")\n| fieldsRemove lookup.id, lookup.entity.name, Tags\n// end of adding ownership info\n| summarize {\n`# Vulnerabilities`=countDistinct(vulnerability.display_id),\n`# Affected entities`=countDistinct(affected_entity.id)\n}, by: {Team}\n| sort {`# Vulnerabilities`, direction:\"descending\"}, {`# Affected entities`, direction:\"descending\"}\n| limit 5","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-04T13:45:20.219Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-04T14:15:20.219Z"}}}},"state":"success","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0}},"result":{"code":200,"value":{"records":[{"Team":"-","# Vulnerabilities":"77","# Affected entities":"13"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.provider == \"Dynatrace\"\n| filter event.type == \"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level == \"ENTITY\"\n| filter isNotNull(dt.entity.process_group)\n| sort timestamp, direction:\"descending\"\n| summarize by:{affected_entity.id, vulnerability.display_id}, takeFirst(dt.entity.process_group), alias:dt.entity.process_group\n| lookup \n\t[\n\t\tfetch dt.entity.process_group\n\t\t| fieldsAdd tags\n\t], sourceField:dt.entity.process_group, lookupField:id\n| fieldsRename lookup.tags, alias:Tags\n| parse toString(Tags), \"LD ('owner:'|'owner\\\\\\\\:') (SPACE)? LD:Team ('\\\"')\"\n| fieldsAdd if(isNotNull(Team), Team, else:\"-\"), alias:Team\n| fieldsRemove lookup.id, lookup.entity.name, Tags\n| summarize by:{Team}, {{countDistinct(vulnerability.display_id), alias:`# Vulnerabilities`}, {countDistinct(affected_entity.id), alias:`# Affected entities`}}\n| sort {`# Vulnerabilities`, direction:\"descending\"}, {`# Affected entities`, direction:\"descending\"}\n| limit 5","timezone":"Europe/Vienna","query":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n| filter isNotNull(dt.entity.process_group)\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{\ndt.entity.process_group=takeFirst(dt.entity.process_group)\n}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n//add ownership information\n| lookup [\nfetch dt.entity.process_group\n| fieldsAdd tags\n], sourceField:dt.entity.process_group, lookupField:id\n| fieldsRename Tags=lookup.tags\n| parse toString(Tags), \"LD ('owner:'|'owner\\\\\\\\:') (SPACE)? LD:Team ('\\\"')\"\n| fieldsAdd Team=if(isNotNull(Team),Team,else:\"-\")\n| fieldsRemove lookup.id, lookup.entity.name, Tags\n// end of adding ownership info\n| summarize {\n`# Vulnerabilities`=countDistinct(vulnerability.display_id),\n`# Affected entities`=countDistinct(affected_entity.id)\n}, by: {Team}\n| sort {`# Vulnerabilities`, direction:\"descending\"}, {`# Affected entities`, direction:\"descending\"}\n| limit 5","scannedRecords":3772,"dqlVersion":"V1_0","scannedBytes":2996464,"analysisTimeframe":{"start":"2023-08-07T14:30:34.040Z","end":"2023-08-07T15:00:34.040Z"},"locale":"","executionTimeMilliseconds":314,"notifications":[],"queryId":"cec61319-a581-463a-b627-5891c42c4580","sampled":false}},"types":[{"mappings":{"Team":{"type":"string"},"# Vulnerabilities":{"type":"long"},"# Affected entities":{"type":"long"}},"indexRange":[0,0]}]},"notifications":[],"dateTime":"2023-08-07T15:00:34.039Z","input":{"value":"fetch events\n| filter event.provider==\"Dynatrace\"\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n| filter event.level==\"ENTITY\"\n| filter isNotNull(dt.entity.process_group)\n// fetch the latest snapshot\n| sort timestamp, direction:\"descending\"\n| summarize \n{\ndt.entity.process_group=takeFirst(dt.entity.process_group)\n}, by: {affected_entity.id, vulnerability.display_id}\n// end of latest snapshot fetch\n//add ownership information\n| lookup [\nfetch dt.entity.process_group\n| fieldsAdd tags\n], sourceField:dt.entity.process_group, lookupField:id\n| fieldsRename Tags=lookup.tags\n| parse toString(Tags), \"LD ('owner:'|'owner\\\\\\\\:') (SPACE)? LD:Team ('\\\"')\"\n| fieldsAdd Team=if(isNotNull(Team),Team,else:\"-\")\n| fieldsRemove lookup.id, lookup.entity.name, Tags\n// end of adding ownership info\n| summarize {\n`# Vulnerabilities`=countDistinct(vulnerability.display_id),\n`# Affected entities`=countDistinct(affected_entity.id)\n}, by: {Team}\n| sort {`# Vulnerabilities`, direction:\"descending\"}, {`# Affected entities`, direction:\"descending\"}\n| limit 5","timeframe":{"from":"now-30m","to":"now","details":{"from":{"type":"expression","normalized":"now-30m","date":"2023-05-04T13:45:20.219Z"},"to":{"type":"expression","normalized":"now","date":"2023-05-04T14:15:20.219Z"}}}}},"visualization":"table","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}},"showInput":false,"height":172,"davisAnalytics":{"analyzerComponentState":{"resultState":{}}},"davisAnalysis":{"analyzerComponentState":{"resultState":{}}}}]}